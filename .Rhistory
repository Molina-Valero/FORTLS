inv(t(Z_sa) %*% Z_sa)
(t(Z_sa) %*% Z_sa)^-1
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
alpha_sa
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
N <- nrow(data.uav)
i_u <- matrix(rep(1/N, times = N))
Z_u <- cbind(rep(1, times = N), uav.metrics$n, uav.metrics$ClosedGapSpace)
Z_sa <- cbind(rep(1, times = nrow(data.50)), uav.metrics$n, uav.metrics$ClosedGapSpace)
X_sa <- cbind(rep(1, times = nrow(data.50)), data.50$V.sh)
X_s <- cbind(rep(1, times = nrow(data.25)), data.25$V.sh)
y_s <- matrix(data.25$V.user)
V.est.uav <- t(i_u) %*% Z_u %*% inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
y_s <- matrix(mod.25$residuals)
V.est.uav <- t(i_u) %*% Z_u %*% inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
alpha_sa <- rbind(-6.696e+01, 5.835e-04, 9.911e+00)
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
i_u <- matrix(rep(1/N, times = N))
Z_u %*% alpha_sa
i_u
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
alpha_sa <- rbind(-6.696e+01, 5.835e-04, 9.911e+00)
alpha_sa
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
first.var <-inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
w_sa <- matrix(mod$residuals)
e_s <- matrix(mod.25$residuals)
first.var <-inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 2 -1)
first.var <-inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
e_s <- (e_s %*% t(e_s)) / (25 - 1 - 1)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov_alpha_sa <- first.var + second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
V.se.uav <- sqrt(var)
var
N <- nrow(data.uav)
i_u <- matrix(rep(1/N, times = N))
Z_u <- cbind(rep(1, times = N), uav.metrics$n, uav.metrics$ClosedGapSpace)
Z_sa <- cbind(rep(1, times = nrow(data.50)), uav.metrics$n, uav.metrics$ClosedGapSpace)
X_sa <- cbind(rep(1, times = nrow(data.50)), data.50$V.sh)
X_s <- cbind(rep(1, times = nrow(data.25)), data.25$V.sh)
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
alpha_sa
Z_sa <- cbind(uav.metrics$n, uav.metrics$ClosedGapSpace)
X_sa <- cbind(data.50$V.sh)
X_s <- cbind(data.25$V.sh)
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
Z_sa <- cbind(uav.metrics$n, uav.metrics$ClosedGapSpace)
X_sa <- cbind(data.50$V.sh)
X_s <- cbind(data.25$V.sh)
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
Z_sa <- cbind(uav.metrics$n, uav.metrics$ClosedGapSpace, rep(1, times = nrow(data.50)))
X_sa <- cbind(data.50$V.sh, rep(1, times = nrow(data.50)))
X_s <- cbind(data.25$V.sh, rep(1, times = nrow(data.25)))
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
summary(uav.metrics$n)
summary(uav.metrics$ClosedGapSpace)
summary(y_s)
summary(Z_sa)
N <- nrow(data.uav)
i_u <- matrix(rep(1/N, times = N))
Z_u <- cbind(rep(1, times = N), uav.metrics$n, uav.metrics$ClosedGapSpace)
Z_sa <- cbind(rep(1, times = nrow(data.50)), uav.metrics$n, uav.metrics$ClosedGapSpace)
X_sa <- cbind(rep(1, times = nrow(data.50)), data.50$V.sh)
X_s <- cbind(rep(1, times = nrow(data.25)), data.25$V.sh)
y_s <- matrix(data.25$V.sh)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
data.25$V.est
data.25$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.25$V.sh
y_s <- matrix(data.25$V.est)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
alpha_sa <- rbind(-6.696e+01, 5.835e-04, 9.911e+00)
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
# data.25$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.25$V.sh
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
5.835e-04
9.911e+00
# data.25$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.25$V.sh
y_s <- matrix(data.25$V.est)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
-6.696e+01
5.835e-04
9.911e+00
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
V.est.uav <- t(i_u) %*% Z_u %*% inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s)
y_s
inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s)
data.25
View(data.25)
id <- c(seq(1, 20, by = 4),
seq(81, 100, by = 4),
seq(161, 180, by = 4),
seq(241, 260, by = 4),
seq(321, 340, by = 4))
data <- sim[sim$radius == 10, ]
data.25 <- data[data$id %in% id, ]
data.25 <- data.25[order(data.25$id), ]
n <- nrow(data.25)
mod.25 <- lm(V.user ~ V.sh, data = data.25)
plot(data.25$V.user~predict(mod.25))
abline(a=1,b=1)
id <- c(seq(1, 20, by = 2),
seq(81, 100, by = 2),
seq(161, 180, by = 2),
seq(241, 260, by = 2),
seq(321, 340, by = 2))
n <- nrow(data.50)
uav.metrics <- data.uav[data.uav$id %in% id, ]
View(uav.metrics)
View(data.uav)
uav.metrics <- uav.metrics[order(uav.metrics$id), ]
uav.metrics <- uav.metrics[, 5:80]
id <- c(seq(1, 20, by = 2),
seq(81, 100, by = 2),
seq(161, 180, by = 2),
seq(241, 260, by = 2),
seq(321, 340, by = 2))
data.50 <- data[data$id %in% id, ]
data.50 <- data.50[order(data.50$id), ]
n <- nrow(data.50)
mod.50 <- lm(V.user ~ V.sh, data = data.50)
uav.metrics$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.50$V.sh
mod <- lm(V.est ~ n + ClosedGapSpace, data = uav.metrics)
plot(uav.metrics$V.est~predict(mod))
N <- nrow(data.uav)
i_u <- matrix(rep(1/N, times = N))
Z_u <- cbind(rep(1, times = N), uav.metrics$n, uav.metrics$ClosedGapSpace)
View(Z_u)
Z_u <- cbind(rep(1, times = N), data.uav$n, data.uav$ClosedGapSpace)
Z_sa <- cbind(rep(1, times = nrow(data.50)), uav.metrics$n, uav.metrics$ClosedGapSpace)
X_sa <- cbind(rep(1, times = nrow(data.50)), data.50$V.sh)
X_s <- cbind(rep(1, times = nrow(data.25)), data.25$V.sh)
# data.25$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.25$V.sh
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
alpha_sa <- (t(Z_sa) %*% Z_sa)^-1 %*% t(Z_sa) %*% X_sa %*% (t(X_s) %*% X_s)^-1 %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
data.uav
# data.25$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.25$V.sh
y_s <- matrix(data.25$V.est)
data.25$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.25$V.sh
y_s <- matrix(data.25$V.est)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
# data.25$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.25$V.sh
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
alpha_sa <- (t(Z_sa) %*% Z_sa)^-1 %*% t(Z_sa) %*% X_sa %*% (t(X_s) %*% X_s)^-1 %*% t(X_s) %*% y_s
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
V.est.uav <- t(i_u) %*% Z_u %*% inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
alpha_sa
length(mod.25)
length(mod.25$residuals)
length(mod.50$residuals)
coef(mod.50)
coef(mod)
mod.25$coefficients[1]
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% rbind(mod.25$coefficients[1], mod.25$coefficients[2])
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
V.est.uav <- t(i_u) %*% Z_u %*% inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
w_sa <- matrix(mod$residuals)
first.var <- ((t(w_sa) %*% w_sa) / (50 - 2 -1)) %*% inv(t(Z_sa) %*% Z_sa)
first.var <- ((t(w_sa) %*% w_sa) / (50 - 2 -1)) %*% (t(Z_sa) %*% Z_sa) ^ -1
((t(w_sa) %*% w_sa) / (50 - 2 -1))
first.var <- ((t(w_sa) %*% w_sa) / (50 - 2 -1)) %*% inv(t(Z_sa) %*% Z_sa)
first.var <- ((t(w_sa) %*% w_sa) / (50 - 2 -1)) * inv(t(Z_sa) %*% Z_sa)
inv(t(Z_sa) %*% Z_sa)
50 - 2 -1
first.var <- ((t(w_sa) %*% w_sa) / 47) %*% inv(t(Z_sa) %*% Z_sa)
w_sa <- matrix(mod$residuals)
first.var <- ((t(w_sa) %*% w_sa) / 47) %*% inv(t(Z_sa) %*% Z_sa)
first.var <- ((t(w_sa) * w_sa) / 47) %*% inv(t(Z_sa) %*% Z_sa)
first.var <- (t(w_sa) %*% w_sa) / 47 %*% inv(t(Z_sa) %*% Z_sa)
first.var <- ((w_sa %*% t(w_sa)) / 47) %*% inv(t(Z_sa) %*% Z_sa)
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 2 -1)
sigma_2
((w_sa %*% t(w_sa)) / 47)
((w_sa %*% t(w_sa)) / 47) %*% inv(t(Z_sa) %*% Z_sa)
first.var <- ((w_sa %*% t(w_sa)) / 47) %*% (t(Z_sa) %*% Z_sa)^-1
inv(t(Z_sa) %*% Z_sa)
t(Z_sa) %*% Z_sa
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
first.var
e_s <- (e_s %*% t(e_s)) / (25 - 1 - 1)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov_alpha_sa <- first.var + second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
mod <- lm(V.est ~ n + ClosedGapSpace, data = uav.metrics)
mod <- step(mod, direction = "both")
summary(mod)
mod <- lm(V.est ~ ClosedGapSpace, data = uav.metrics)
summary(mod)
plot(uav.metrics$V.est~predict(mod))
abline(a=1,b=1)
N <- nrow(data.uav)
i_u <- matrix(rep(1/N, times = N))
Z_u <- cbind(rep(1, times = N), data.uav$ClosedGapSpace)
Z_sa <- cbind(rep(1, times = nrow(data.50)), uav.metrics$ClosedGapSpace)
X_sa <- cbind(rep(1, times = nrow(data.50)), data.50$V.sh)
X_s <- cbind(rep(1, times = nrow(data.25)), data.25$V.sh)
# data.25$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.25$V.sh
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
mod$coefficients
alpha_sa
V.est.uav <- t(i_u) %*% Z_u %*% inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
V.est.uav <- t(i_u) %*% Z_u %*% inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
first.var <- ((w_sa %*% t(w_sa)) / 47) %*% inv(t(Z_sa) %*% Z_sa)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov_alpha_sa <- first.var + second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
V.se.uav <- sqrt(var)
w_sa <- matrix(mod$residuals)
e_s <- matrix(mod.25$residuals)
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 2 -1)
e_s <- (e_s %*% t(e_s)) / (25 - 1 - 1)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
first.var <- ((w_sa %*% t(w_sa)) / 47) %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov_alpha_sa <- first.var + second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
V.se.uav <- sqrt(var)
mod$residuals
w_sa
data.uav <- read.csv("G:/Unidades compartidas/Latinos/processed_pointcloud/After/Metrics_After.csv")
id <- c(seq(1, 20, by = 2),
seq(81, 100, by = 2),
seq(161, 180, by = 2),
seq(241, 260, by = 2),
seq(321, 340, by = 2))
n <- nrow(data.50)
uav.metrics <- data.uav[data.uav$id %in% id, ]
uav.metrics <- uav.metrics[order(uav.metrics$id), ]
uav.metrics <- uav.metrics[, 5:80]
uav.metrics$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.50$V.sh
mod <- lm(V.est ~ ClosedGapSpace, data = uav.metrics)
summary(mod)
plot(uav.metrics$V.est~predict(mod))
abline(a=1,b=1)
N <- nrow(data.uav)
i_u <- matrix(rep(1/N, times = N))
Z_u <- cbind(rep(1, times = N), data.uav$ClosedGapSpace)
Z_sa <- cbind(rep(1, times = nrow(data.50)), uav.metrics$ClosedGapSpace)
X_sa <- cbind(rep(1, times = nrow(data.50)), data.50$V.sh)
X_s <- cbind(rep(1, times = nrow(data.25)), data.25$V.sh)
# data.25$V.est <- coef(mod.50)[1] + coef(mod.50)[2] * data.25$V.sh
y_s <- matrix(data.25$V.user)
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
rm(V.est.uav)
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
first.var <- (t(w_sa) %*% w_sa) / 47) %*% inv(t(Z_sa) %*% Z_sa)
first.var <- ((t(w_sa) %*% w_sa) / 47) %*% inv(t(Z_sa) %*% Z_sa)
sigma_2 <- (t(w_sa) %*% w_sa) / (50 - 2 -1)
sigma_2
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 2 -1)
sigma_2
first.var <- sigma_2 %*% inv(t(Z_sa) %*% Z_sa)
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 2 -1)
inv(t(Z_sa) %*% Z_sa)
first.var <- sigma_2 %*% (t(Z_sa) %*% Z_sa)^-1
(t(Z_sa) %*% Z_sa)^-1
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
e_s <- (e_s %*% t(e_s)) / (25 - 1 - 1)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov_alpha_sa <- first.var + second.var
cov_alpha_sa
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
var
Z_u
alpha_sa <- (t(Z_sa) %*% Z_sa)^-1 %*% t(Z_sa) %*% X_sa %*% (t(X_s) %*% X_s)^-1 %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
alpha_sa <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% y_s
V.est.uav <- t(i_u) %*% Z_u %*% alpha_sa
w_sa <- matrix(mod$residuals)
View(w_sa)
e_s <- matrix(mod.25$residuals)
View(e_s)
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 1 -1)
e_s <- (e_s %*% t(e_s)) / (25 - 1 - 1)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
first.var <- sigma_2 %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- (t(Z_sa) %*% Z_sa) ^ -1 %*% t(Z_sa) %*% X_sa %*% (e_s %*% (t(X_s) %*% X_s) ^ -1) %*% t(X_sa) %*% Z_sa %*% (t(Z_sa) %*% Z_sa) ^ -1
cov_alpha_sa <- first.var + second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
w_sa <- matrix(mod$residuals)
e_s <- matrix(mod.25$residuals)
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 1 -1)
e_s <- (e_s %*% t(e_s)) / (25 - 1 - 1)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
first.var <- sigma_2 %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- (t(Z_sa) %*% Z_sa) ^ -1 %*% t(Z_sa) %*% X_sa %*% (e_s %*% (t(X_s) %*% X_s) ^ -1) %*% t(X_sa) %*% Z_sa %*% (t(Z_sa) %*% Z_sa) ^ -1
cov_alpha_sa <- first.var + second.var
t(i_u)
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
V.se.uav <- sqrt(abs(var))
Z_u
t(Z_u)
i_u
cov_alpha_sa
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov_alpha_sa <- first.var %*% second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
cov_alpha_sa <- first.var + second.var
cov_alpha_sa
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 1 -1)
sigma_2
sigma_2 <- (t(w_sa) %*% w_sa) / (50 - 1 -1)
first.var <- sigma_2 %*% inv(t(Z_sa) %*% Z_sa)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
first.var <- sigma_2 %*% (t(Z_sa) %*% Z_sa)^-1
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
beta <- matrix(mod$coefficients)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) (X_sa %*% cov(beta) %*% t(X_sa)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov(beta)
beta <- matrix(mod$coefficients)
beta
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) (X_sa %*% cov(beta) %*% t(X_sa)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
X_sa %*% cov(beta) %*% t(X_sa)
X_sa %*% cov(beta)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) (X_sa %*% matrix(cov(beta)) %*% t(X_sa)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 1 -1)
e_s <- (e_s %*% t(e_s)) / (25 - 1 - 1)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov_alpha_sa <- first.var + second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
cov_alpha_sa
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 1 - 0)
e_s <- (e_s %*% t(e_s)) / (25 - 1 - 1)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 %*% diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov_alpha_sa <- first.var + second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 1 - 1)
first.var <- sigma_2 %*% inv(t(Z_sa) %*% Z_sa)
first.var <- sigma_2 * inv(t(Z_sa) %*% Z_sa)
class(sigma_2)
w_sa <- matrix(mod$residuals)
e_s <- matrix(mod.25$residuals)
V.se.uav <- sqrt(abs(var))
V.se.uav/V.est.uav
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) * (e_s %*% diag(25)) * X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) * (e_s * diag(25)) * X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
e_s
e_s %*% diag(25)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s %*% diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
w_sa <- matrix(mod$residuals)
e_s <- matrix(mod.25$residuals)
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 1 - 1)
e_s <- (e_s %*% t(e_s)) / (25 - 1 - 1)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s * diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var
cov_alpha_sa <- first.var + second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
sigma_2 <- (w_sa * t(w_sa)) / (50 - 1 - 1)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 * diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s * diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
cov_alpha_sa <- first.var + second.var
var <- t(i_u) %*% Z_u %*% cov_alpha_sa %*% t(Z_u) %*% i_u
V.se.uav <- sqrt(abs(var))
V.se.uav <- sqrt(var)
V.se.uav/V.est.uav
sigma_2 <- (w_sa %*% t(w_sa)) / (50 - 1 - 1)
first.var <- sigma_2 %*% inv(t(Z_sa) %*% Z_sa)
first.var <- sigma_2 * inv(t(Z_sa) %*% Z_sa)
first.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% (sigma_2 * diag(50)) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
second.var <- inv(t(Z_sa) %*% Z_sa) %*% t(Z_sa) %*% X_sa %*% inv(t(X_s) %*% X_s) %*% t(X_s) %*% (e_s * diag(25)) %*% X_s %*% inv(t(X_s) %*% X_s) %*% t(X_sa) %*% Z_sa %*% inv(t(Z_sa) %*% Z_sa)
estimaciones$V.est.uav.25 <- ifelse(estimaciones$n == n, V.est.uav, NA)
estimaciones$V.se.uav.25 <- ifelse(estimaciones$n == n, V.se.uav, NA)
estimaciones$V.se.uav.25.rel <- estimaciones$V.se.uav.25 / estimaciones$V.est.uav.25
plot(estimaciones$V.se.srs.rel~estimaciones$n,
xlab = "n (number of field plots)",
ylab = "Standard error (m3/ha)",
ylim = c(0, 0.15),
col = "grey", pch = 19)
asis <- estimaciones[!is.na(estimaciones$V.est.asis.25), ]
points(asis$V.se.asis.25.rel~asis$n,
xlab = "n (number of field plots)",
ylab = "Standard error (m3/ha)",
col = "green", pch = 19)
estlowess <- lowess(asis$n, asis$V.se.asis.25.rel, f=0.05)
lines(estlowess,lwd=2, col = "green")
abline(v=78)
points(asis$V.se.asis.50.rel~asis$n,
xlab = "n (number of field plots)",
ylab = "Standard error (m3/ha)",
col = "blue", pch = 19)
estlowess <- lowess(asis$n, asis$V.se.asis.50.rel, f=0.05)
lines(estlowess,lwd=2, col = "blue")
abline(v=123)
points(asis$V.se.uav.25.rel~asis$n,
xlab = "n (number of field plots)",
ylab = "Standard error (m3/ha)",
col = "red", pch = 19)
estlowess <- lowess(asis$n, asis$V.se.uav.25.rel, f=0.05)
lines(estlowess,lwd=2, col = "red")
plot(estimaciones$V.est.srs~estimaciones$n,
xlab = "n (number of field plots)",
ylab = "Standard error (m3/ha)",
col = "grey", pch = 19)
estlowess <- lowess(estimaciones$n, estimaciones$V.est.srs, f=0.05)
lines(estlowess,lwd=2)
asis <- estimaciones[!is.na(estimaciones$V.est.asis.25), ]
points(asis$V.est.asis.25~asis$n,
xlab = "n (number of field plots)",
ylab = "Standard error (m3/ha)",
col = "green", pch = 19)
estlowess <- lowess(asis$n, asis$V.est.asis.25, f=0.05)
lines(estlowess,lwd=2, col = "green")
points(asis$V.est.asis.50~asis$n,
xlab = "n (number of field plots)",
ylab = "Standard error (m3/ha)",
col = "blue", pch = 19)
estlowess <- lowess(asis$n, asis$V.est.asis.50, f=0.05)
lines(estlowess,lwd=2, col = "blue")
abline(h=248)
points(asis$V.est.uav.25~asis$n,
xlab = "n (number of field plots)",
ylab = "Standard error (m3/ha)",
col = "red", pch = 19)
hist(mod$coefficients[1]+mod$coefficients[2]*data.uav$ClosedGapSpace)
boxplot(mod$coefficients[1]+mod$coefficients[2]*data.uav$ClosedGapSpace)
3
plot((mod$coefficients[1]+mod$coefficients[2]*data.uav$ClosedGapSpace)~data.uav$id)
data.uav$V.est <- mod$coefficients[1]+mod$coefficients[2]*data.uav$ClosedGapSpace
View(data.uav)
library(FORTLS)
setwd("C:/Acosta")
pcd <- normalize(las = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206.las",
id = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206",
x.center = 781922.274203, y.center = 183774.968739,
max.dist = 15.5)
tree.tls <-
tree.detection.single.scan(data = pcd,
bark.roughness = 1,
stem.section = c(0.5, 4.5),
tls.resolution =
list(point.dist = 6, tls.dist = 10))
library(FORTLS)
setwd("C:/Acosta")
pcd <- normalize(las = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206.las",
id = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206",
x.center = 781922.274203, y.center = 183774.968739,
max.dist = 5)
tree.tls <-
tree.detection.single.scan(data = pcd,
bark.roughness = 1,
stem.section = c(0.5, 4.5),
tls.resolution =
list(point.dist = 6, tls.dist = 10))
library(FORTLS)
pcd <- normalize(las = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206.laz",
id = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206",
x.center = 781922.274203, y.center = 183774.968739,
max.dist = 5)
setwd("C:/Acosta")
pcd <- normalize(las = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206.laz",
id = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206",
x.center = 781922.274203, y.center = 183774.968739,
max.dist = 5)
tree.tls <-
tree.detection.single.scan(data = pcd,
bark.roughness = 1,
stem.section = c(0.5, 4),
tls.resolution =
list(point.dist = 6, tls.dist = 10))
library(FORTLS)
setwd("C:/Acosta")
pcd <- normalize2(las = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206.laz",
id = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup206",
x.center = 781922.274203, y.center = 183774.968739,
max.dist = 4)
summary(pcd)
setwd("C:/Acosta")
pcd <- normalize2(las = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup207.laz",
id = "Gum_Stump_all_TLS_Job 002 gum stmp- Setup207",
x.center = 781913.728577, y.center = 183749.090664,
max.dist = 7.5)

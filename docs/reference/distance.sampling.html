<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Distance Sampling Methods for Correcting Occlusions Effects — distance.sampling • FORTLS</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Distance Sampling Methods for Correcting Occlusions Effects — distance.sampling"><meta property="og:description" content="Calculation of the probability of detection of every tree by using distance sampling methodologies (more specifically point transects methods), by means of fitting detection functions to the histogram of tree distribution according to their distance to TLS. Use both half normal and hazard rate functions, without and with dbh as covariate. These probabilities are used for correcting estimation bias caused by lack of detection of trees due to occlusion."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FORTLS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/stand_level.html">Stand level</a>
    </li>
    <li>
      <a href="../articles/tree_level.html">Tree-level</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Molina-Valero/FORTLS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Distance Sampling Methods for Correcting Occlusions Effects</h1>
    
    <div class="hidden name"><code>distance.sampling.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculation of the probability of detection of every tree by using distance sampling methodologies (more specifically point transects methods), by means of fitting detection functions to the histogram of tree distribution according to their distance to TLS. Use both half normal and hazard rate functions, without and with <em>dbh</em> as covariate. These probabilities are used for correcting estimation bias caused by lack of detection of trees due to occlusion.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">distance.sampling</span><span class="op">(</span><span class="va">tree.tls</span>,
                  id.plots <span class="op">=</span> <span class="cn">NULL</span>,
                  strata.attributes <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>tree.tls</dt>
<dd><p>Data frame with a list of trees detected and their <em>dbh</em> and horizontal distances from TLS with the same structure and format as <code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code> and <code><a href="tree.detection.several.plots.html">tree.detection.several.plots</a></code> ‘Value’.</p></dd>
<dt>id.plots</dt>
<dd><p>Optional vector with plot identification encoded as character string or numeric for the plots considered. In this case, <code>tree.tls</code> argument must include a common column named ‘id’. If this argument is not specified by the user, it will be set to NULL by default, and as a consequence, all plots will be considered.</p></dd>
<dt>strata.attributes</dt>
<dd><p>Optional data frame inluding plot radius considered at strata level. It must contain a column named ‘stratum’ (numeric) with encoding coinciding with that used in previous functions (<code><a href="normalize.html">normalize</a></code>, <code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code> and <code><a href="tree.detection.several.plots.html">tree.detection.several.plots</a></code>) for identifying strata. Therefore, strata must heve been included previously in ‘tree.tls’. Another column named ‘plot.radius’ (numeric) will be required to set maximum horizontal distance (m) considered for fitting detection probability functions. If this argument is not specified by the user, it will be set to NULL by default, and as a consequence, all trees will be included.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>All internal functions related to distance sampling methodologies are fitted with the <code><a href="https://rdrr.io/pkg/Distance/man/ds.html" class="external-link">ds</a></code> function included in the <a href="https://CRAN.R-project.org/package=Distance" class="external-link"><span class="pkg">Distance</span></a> package.</p>
<p>Detection functions are left-truncated at 1 m, according to Astrup et al., (2014).</p>
<p>Same warning messages as <code><a href="https://rdrr.io/pkg/Distance/man/ds.html" class="external-link">ds</a></code> function are provided when fits do not converge or another warnings occur.</p>
<p>For further details on these point transects methods  and similar sampling methodologies, as well as their application with R, see Buckland et al., (2001); Marques &amp; Buckland, (2003); Miller &amp; Thomas, (2015) and Clark (2016). Examples of distance sampling analyses, as well as lectures, are available at <a href="http://examples.distancesampling.org/" class="external-link">http://examples.distancesampling.org/</a> and <a href="http://workshops.distancesampling.org/" class="external-link">http://workshops.distancesampling.org/</a>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>List containing the following elements:</p>
<dl><dt>tree</dt>
<dd><p>Data frame with detection probabilities for every tree and method.</p></dd>
</dl><ul><li><p><code>stratum</code>: stratum identification (coincident with strata of <code>tree.tls</code>). If there are not strata, it will be set as a single stratum encoded as 1 (numeric).</p></li>
<li><p><code>id</code>: plot identification (coincident with id of <code>tree.tls</code>).</p></li>
<li><p><code>tree</code>: tree numbering (coincident with <code>tree</code> of <code>tree.tls</code>).</p></li>
<li><p><code>P.hn</code>: tree detection probability according to half normal function.</p></li>
<li><p><code>P.hn.cov</code>: tree detection probability according to half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hr</code>: tree detection probability according to half rate function.</p></li>
<li><p><code>P.hr.cov</code>: tree detection probability according to half rate function with <em>dbh</em> as covariate.</p></li>
</ul><dl><dt>parameters</dt>
<dd><p>Data frame with parameters estimated for detection functions (see references for understanding their meaning).</p></dd>
</dl><ul><li><p><code>P.hn.scale</code>: scale parameter for half normal function (sigma).</p></li>
<li><p><code>P.hn.cov.scale.intercept</code>: alpha.0 parameter of scale parameter for half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hn.cov.dbh</code>: alpha.1 parameter of scale parameter for half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hr.scale</code>: scale parameter for half rate function (sigma).</p></li>
<li><p><code>P.hr.shape</code>: shape parameter for half rate function (b).</p></li>
<li><p><code>P.hr.cov.scale.intercept</code>: alpha.0 parameter of scale parameter for half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hr.cov.dbh</code>: alpha.1 parameter of scale parameter for half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hr.cov.shape</code>: shape parameter for half rate function with <em>dbh</em> as covariate (b).</p></li>
</ul><dl><dt>AIC</dt>
<dd><p>Data frame with Akaike information criterions (AIC) of every detection function fit.</p></dd>
</dl><ul><li><p><code>P.hn</code>: AIC of half normal function fit.</p></li>
<li><p><code>P.hn.cov</code>:  AIC of half normal function with <em>dbh</em> as covariate fit.</p></li>
<li><p><code>P.hr</code>:  AIC of half rate function fit.</p></li>
<li><p><code>P.hr.cov</code>:  AIC of half rate function with <em>dbh</em> as covariate fit.</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>Although this step is optional for other functionalities of <span class="pkg">FORTLS</span>, such as obtaining metrics and assessing the best plot designs (implemented in <code><a href="metrics.variables.html">metrics.variables</a></code>, <code><a href="correlations.html">correlations</a></code>, <code><a href="relative.bias.html">relative.bias</a></code> and <code><a href="optimize.plot.design.html">optimize.plot.design</a></code>), its inclusion is highly recommended, especially with high rates of occlusions.</p>
<p>Note that this function could be more useful after assessing the best possible plot design with <code><a href="estimation.plot.size.html">estimation.plot.size</a></code>, <code><a href="correlations.html">correlations</a></code>, <code><a href="relative.bias.html">relative.bias</a></code> or <code><a href="optimize.plot.design.html">optimize.plot.design</a></code> functions.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Astrup, R., Ducey, M. J., Granhus, A., Ritter, T., &amp; von Lüpke, N. (2014). Approaches for estimating stand-level volume using terrestrial laser scanning in a single-scan mode. <em>Canadian Journal of Forest Research</em>, <b>44(6)</b>, 666-676. doi: <a href="https://doi.org/10.1139/cjfr-2013-0535" class="external-link">10.1139/cjfr-2013-0535</a>
.</p>
<p>Buckland, S. T., Anderson, D. R., Burnham, K. P., Laake, J. L., Borchers, D. L., &amp; Thomas, L. (2001). <em>Introduction to distance sampling: estimating abundance of biological populations</em>, Oxford, United Kindown, Oxford University Press.</p>
<p>Clark, R. G. (2016). Statistical efficiency in distance sampling. <em>PloS one</em>, <b>11(3)</b>, e0149298. doi: <a href="https://doi.org/10.1371/journal.pone.0149298" class="external-link">10.1371/journal.pone.0149298</a>
.</p>
<p>Marques, F. F., &amp; Buckland, S. T. (2003). Incorporating covariates into standard line transect analyses. <em>Biometrics</em>, <b>59(4)</b>, 924-935. doi: <a href="https://doi.org/10.1111/j.0006-341X.2003.00107.x" class="external-link">10.1111/j.0006-341X.2003.00107.x</a>
.</p>
<p>Miller, D. L., &amp; Thomas, L. (2015). Mixture models for distance sampling detection functions. <em>PloS one</em>, <b>10(3)</b>, e0118726. doi: <a href="https://doi.org/10.1371/journal.pone.0118726" class="external-link">10.1371/journal.pone.0118726</a>
.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Juan Alberto Molina-Valero
and Adela Martínez-Calvo.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code>, <code><a href="tree.detection.several.plots.html">tree.detection.several.plots</a></code>, <code><a href="metrics.variables.html">metrics.variables</a></code>, <code><a href="simulations.html">simulations</a></code>.</p>
<p><code>ds</code> in <a href="https://CRAN.R-project.org/package=Distance" class="external-link"><span class="pkg">Distance</span></a> package.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Loading example data</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rioja.data</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">tree.tls</span> <span class="op">&lt;-</span> <span class="va">Rioja.data</span><span class="op">$</span><span class="va">tree.tls</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Whithout considering maximum distance</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu">distance.sampling</span><span class="op">(</span><span class="va">tree.tls</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in 1:nrow(.data):</span> argument of length 0</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Considering only some plots (first 8 plots)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu">distance.sampling</span><span class="op">(</span><span class="va">tree.tls</span>, id.plots <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in .data[is.element(.data$id, id.plots), , drop = FALSE]:</span> incorrect number of dimensions</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Juan Alberto Molina-Valero, Adela Martínez-Calvo, Juan Gabriel Álvarez-González, Fernando Montes, César Pérez-Cruzado.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>


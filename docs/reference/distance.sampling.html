<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Distance Sampling Methods for Correcting Occlusions Effects — distance.sampling • FORTLS</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Distance Sampling Methods for Correcting Occlusions Effects — distance.sampling"><meta name="description" content="Calculation of the probability of detection of every tree by using distance sampling methodologies (more specifically point transects methods), by means of fitting detection functions to the histogram of tree distribution according to their distance to TLS. Use both half normal and hazard rate functions, without and with dbh as covariate. These probabilities are used for correcting estimation bias caused by lack of detection of trees due to occlusion."><meta property="og:description" content="Calculation of the probability of detection of every tree by using distance sampling methodologies (more specifically point transects methods), by means of fitting detection functions to the histogram of tree distribution according to their distance to TLS. Use both half normal and hazard rate functions, without and with dbh as covariate. These probabilities are used for correcting estimation bias caused by lack of detection of trees due to occlusion."><meta property="og:image" content="https://molina-valero.github.io/FORTLS/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FORTLS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/plot_design_optimization.html">Plot design optimization</a></li>
    <li><a class="dropdown-item" href="../articles/stand_level.html">Stand-level variables</a></li>
    <li><a class="dropdown-item" href="../articles/tree_level.html">Tree-level variables</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Molina-Valero/FORTLS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Distance Sampling Methods for Correcting Occlusions Effects</h1>

      <div class="d-none name"><code>distance.sampling.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculation of the probability of detection of every tree by using distance sampling methodologies (more specifically point transects methods), by means of fitting detection functions to the histogram of tree distribution according to their distance to TLS. Use both half normal and hazard rate functions, without and with <em>dbh</em> as covariate. These probabilities are used for correcting estimation bias caused by lack of detection of trees due to occlusion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">distance.sampling</span><span class="op">(</span><span class="va">tree.tls</span>,</span>
<span>                  id.plots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  strata.attributes <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<p></p>
<dl><dt id="arg-tree-tls">tree.tls<a class="anchor" aria-label="anchor" href="#arg-tree-tls"></a></dt>
<dd><p>Data frame with a list of trees detected and their <em>dbh</em> and horizontal distances from TLS with the same structure and format as <code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code> and <code><a href="tree.detection.several.plots.html">tree.detection.several.plots</a></code> ‘Value’.</p></dd>


  <dt id="arg-id-plots">id.plots<a class="anchor" aria-label="anchor" href="#arg-id-plots"></a></dt>
<dd><p>Optional vector with plot identification encoded as character string or numeric for the plots considered. In this case, <code>tree.tls</code> argument must include a common column named ‘id’. If this argument is not specified by the user, it will be set to NULL by default, and as a consequence, all plots will be considered.</p></dd>


  <dt id="arg-strata-attributes">strata.attributes<a class="anchor" aria-label="anchor" href="#arg-strata-attributes"></a></dt>
<dd><p>Optional data frame inluding plot radius considered at strata level. It must contain a column named ‘stratum’ (numeric) with encoding coinciding with that used in previous functions (<code><a href="normalize.html">normalize</a></code>, <code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code> and <code><a href="tree.detection.several.plots.html">tree.detection.several.plots</a></code>) for identifying strata. Therefore, strata must heve been included previously in ‘tree.tls’. Another column named ‘plot.radius’ (numeric) will be required to set maximum horizontal distance (m) considered for fitting detection probability functions. If this argument is not specified by the user, it will be set to NULL by default, and as a consequence, all trees will be included.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>All internal functions related to distance sampling methodologies are fitted with the <a href="https://rdrr.io/pkg/Distance/man/ds.html" class="external-link">ds</a> function included in the <a href="https://CRAN.R-project.org/package=Distance" class="external-link"><span class="pkg">Distance</span></a> package.</p>
<p>Detection functions are left-truncated at 1 m, according to Astrup et al., (2014).</p>
<p>Same warning messages as <a href="https://rdrr.io/pkg/Distance/man/ds.html" class="external-link">ds</a> function are provided when fits do not converge or another warnings occur.</p>
<p>For further details on these point transects methods  and similar sampling methodologies, as well as their application with R, see Buckland et al., (2001); Marques &amp; Buckland, (2003); Miller &amp; Thomas, (2015) and Clark (2016). Examples of distance sampling analyses, as well as lectures, are available at <a href="https://distancesampling.org/resources/vignettes.html" class="external-link">https://distancesampling.org/resources/vignettes.html</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List containing the following elements:</p>
<dl><dt>tree</dt>
<dd><p>Data frame with detection probabilities for every tree and method.</p></dd>


</dl><ul><li><p><code>stratum</code>: stratum identification (coincident with strata of <code>tree.tls</code>). If there are not strata, it will be set as a single stratum encoded as 1 (numeric).</p></li>
<li><p><code>id</code>: plot identification (coincident with id of <code>tree.tls</code>).</p></li>
<li><p><code>tree</code>: tree numbering (coincident with <code>tree</code> of <code>tree.tls</code>).</p></li>
<li><p><code>P.hn</code>: tree detection probability according to half normal function.</p></li>
<li><p><code>P.hn.cov</code>: tree detection probability according to half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hr</code>: tree detection probability according to half rate function.</p></li>
<li><p><code>P.hr.cov</code>: tree detection probability according to half rate function with <em>dbh</em> as covariate.</p></li>
</ul><dl><dt>parameters</dt>
<dd><p>Data frame with parameters estimated for detection functions (see references for understanding their meaning).</p></dd>


</dl><ul><li><p><code>P.hn.scale</code>: scale parameter for half normal function (sigma).</p></li>
<li><p><code>P.hn.cov.scale.intercept</code>: alpha.0 parameter of scale parameter for half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hn.cov.dbh</code>: alpha.1 parameter of scale parameter for half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hr.scale</code>: scale parameter for half rate function (sigma).</p></li>
<li><p><code>P.hr.shape</code>: shape parameter for half rate function (b).</p></li>
<li><p><code>P.hr.cov.scale.intercept</code>: alpha.0 parameter of scale parameter for half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hr.cov.dbh</code>: alpha.1 parameter of scale parameter for half normal function with <em>dbh</em> as covariate.</p></li>
<li><p><code>P.hr.cov.shape</code>: shape parameter for half rate function with <em>dbh</em> as covariate (b).</p></li>
</ul><dl><dt>AIC</dt>
<dd><p>Data frame with Akaike information criterions (AIC) of every detection function fit.</p></dd>


</dl><ul><li><p><code>P.hn</code>: AIC of half normal function fit.</p></li>
<li><p><code>P.hn.cov</code>:  AIC of half normal function with <em>dbh</em> as covariate fit.</p></li>
<li><p><code>P.hr</code>:  AIC of half rate function fit.</p></li>
<li><p><code>P.hr.cov</code>:  AIC of half rate function with <em>dbh</em> as covariate fit.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Although this step is optional for other functionalities of <span class="pkg">FORTLS</span>, such as obtaining metrics and assessing the best plot designs (implemented in <code><a href="metrics.variables.html">metrics.variables</a></code>, <code><a href="correlations.html">correlations</a></code>, <code><a href="relative.bias.html">relative.bias</a></code> and <code><a href="optimize.plot.design.html">optimize.plot.design</a></code>), its inclusion is highly recommended, especially with high rates of occlusions.</p>
<p>Note that this function could be more useful after assessing the best possible plot design with <code><a href="estimation.plot.size.html">estimation.plot.size</a></code>, <code><a href="correlations.html">correlations</a></code>, <code><a href="relative.bias.html">relative.bias</a></code> or <code><a href="optimize.plot.design.html">optimize.plot.design</a></code> functions.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Astrup, R., Ducey, M. J., Granhus, A., Ritter, T., &amp; von Lüpke, N. (2014). Approaches for estimating stand-level volume using terrestrial laser scanning in a single-scan mode. <em>Canadian Journal of Forest Research</em>, <b>44(6)</b>, 666-676. <a href="https://doi.org/10.1139/cjfr-2013-0535" class="external-link">doi:10.1139/cjfr-2013-0535</a>
.</p>
<p>Buckland, S. T., Anderson, D. R., Burnham, K. P., Laake, J. L., Borchers, D. L., &amp; Thomas, L. (2001). <em>Introduction to distance sampling: estimating abundance of biological populations</em>, Oxford, United Kindown, Oxford University Press.</p>
<p>Clark, R. G. (2016). Statistical efficiency in distance sampling. <em>PloS one</em>, <b>11(3)</b>, e0149298. <a href="https://doi.org/10.1371/journal.pone.0149298" class="external-link">doi:10.1371/journal.pone.0149298</a>
.</p>
<p>Marques, F. F., &amp; Buckland, S. T. (2003). Incorporating covariates into standard line transect analyses. <em>Biometrics</em>, <b>59(4)</b>, 924-935. <a href="https://doi.org/10.1111/j.0006-341X.2003.00107.x" class="external-link">doi:10.1111/j.0006-341X.2003.00107.x</a>
.</p>
<p>Miller, D. L., &amp; Thomas, L. (2015). Mixture models for distance sampling detection functions. <em>PloS one</em>, <b>10(3)</b>, e0118726. <a href="https://doi.org/10.1371/journal.pone.0118726" class="external-link">doi:10.1371/journal.pone.0118726</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Juan Alberto Molina-Valero
and Adela Martínez-Calvo.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code>, <code><a href="tree.detection.several.plots.html">tree.detection.several.plots</a></code>, <code><a href="metrics.variables.html">metrics.variables</a></code>, <code><a href="simulations.html">simulations</a></code>.</p>
<p><a href="https://rdrr.io/pkg/Distance/man/ds.html" class="external-link">ds</a> in <a href="https://CRAN.R-project.org/package=Distance" class="external-link"><span class="pkg">Distance</span></a> package.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Loading example data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rioja.data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tree.tls</span> <span class="op">&lt;-</span> <span class="va">Rioja.data</span><span class="op">$</span><span class="va">tree.tls</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Whithout considering maximum distance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu">distance.sampling</span><span class="op">(</span><span class="va">tree.tls</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juan Alberto Molina-Valero, Adela Martínez-Calvo, María José Ginzo Villamayor, Juan Gabriel Álvarez-González, Fernando Montes, César Pérez-Cruzado.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>


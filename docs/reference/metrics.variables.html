<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute Metrics and Variables for Terrestrial-Based Technologies Point Clouds — metrics.variables • FORTLS</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Metrics and Variables for Terrestrial-Based Technologies Point Clouds — metrics.variables"><meta name="description" content="This function computes a set of metrics and variables from the Terrestrial-Based Technologies point cloud data, which have a high potential to be related or used as direct estimates (in the case of variables) of forest attributes at plot level. These can be obtained for different plot designs (circular fixed area, k-tree and angle-count plots). This function also includes methodologies for correcting occlusions generated in TLS single-scan point clouds."><meta property="og:description" content="This function computes a set of metrics and variables from the Terrestrial-Based Technologies point cloud data, which have a high potential to be related or used as direct estimates (in the case of variables) of forest attributes at plot level. These can be obtained for different plot designs (circular fixed area, k-tree and angle-count plots). This function also includes methodologies for correcting occlusions generated in TLS single-scan point clouds."><meta property="og:image" content="https://molina-valero.github.io/FORTLS/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FORTLS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/plot_design_optimization.html">Plot design optimization</a></li>
    <li><a class="dropdown-item" href="../articles/stand_level.html">Stand-level variables</a></li>
    <li><a class="dropdown-item" href="../articles/tree_level.html">Tree-level variables</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Molina-Valero/FORTLS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute Metrics and Variables for Terrestrial-Based Technologies Point Clouds</h1>

      <div class="d-none name"><code>metrics.variables.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes a set of metrics and variables from the Terrestrial-Based Technologies point cloud data, which have a high potential to be related or used as direct estimates (in the case of variables) of forest attributes at plot level. These can be obtained for different plot designs (circular fixed area, k-tree and angle-count plots). This function also includes methodologies for correcting occlusions generated in TLS single-scan point clouds.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">metrics.variables</span><span class="op">(</span><span class="va">tree.tls</span>, tree.ds <span class="op">=</span> <span class="cn">NULL</span>, tree.field <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  plot.design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fixed.area"</span>, <span class="st">"k.tree"</span>, <span class="st">"angle.count"</span><span class="op">)</span>,</span>
<span>                  plot.parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">25</span>, k <span class="op">=</span> <span class="fl">10</span>, BAF <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                  scan.approach <span class="op">=</span> <span class="st">"single"</span>,</span>
<span>                  var.metr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tls <span class="op">=</span> <span class="cn">NULL</span>, field <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>                  v.calc <span class="op">=</span> <span class="st">"parab"</span>, dbh.min <span class="op">=</span> <span class="fl">4</span>, h.min <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>                  max.dist <span class="op">=</span> <span class="cn">Inf</span>, dir.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  save.result <span class="op">=</span> <span class="cn">TRUE</span>, dir.result <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<p></p>
<dl><dt id="arg-tree-tls">tree.tls<a class="anchor" aria-label="anchor" href="#arg-tree-tls"></a></dt>
<dd><p>Data frame with information about trees detected from terrestrial-based technologies point clouds data in the same format as <code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code> or <code><a href="tree.detection.multi.scan.html">tree.detection.multi.scan</a></code> ‘Values’.</p></dd>


  <dt id="arg-tree-ds">tree.ds<a class="anchor" aria-label="anchor" href="#arg-tree-ds"></a></dt>
<dd><p>Optional list containing detection probabilities of trees with distance sampling methods. The format must be the same as the ‘Value’ obtained with <code><a href="distance.sampling.html">distance.sampling</a></code>. If this argument is not specified by the user, it will be set to NULL by default and, as a consequence, TLS metrics using distance sampling based correction will not be calculated for circular fixed area and k-tree plot designs.</p></dd>


    <dt id="arg-tree-field">tree.field<a class="anchor" aria-label="anchor" href="#arg-tree-field"></a></dt>
<dd><p>Data frame with information about trees measured in the field plots. Each
  row must correspond to a (plot, tree) pair, and it must include at least the
  following columns:</p><ul><li><p><code>id</code>: plot identification encoded as character string or
      numeric. Plot identifications must coincide with those
      included in <code>id</code> column of the <code>tree.tls</code> argument.</p></li>
<li><p><code>tree</code>: trees numbering.</p></li>
<li><p><code>h.dist</code>: horizontal distance (m) from plot
      centre to tree centre. Centres of the field plots must coincide with
      centres of their corresponding Terrestrial-based technologies plots.</p></li>
<li><p><code>dbh</code>: tree diameter (cm) at breast height (1.3 m).</p></li>
<li><p><code>h</code>: tree total height (m).</p></li>
<li><p><code>h.blc</code>: height based live crown (m) (optional).</p></li>
<li><p><code>h.bdc</code>: height based dead crown (m) (optional).</p></li>
<li><p><code>v.user</code>: tree volume (m^3) (optional).</p></li>
<li><p><code>w.user</code>: tree biomass (Mg) (optional).</p></li>
<li><p><code>dead</code>: integer value indicating for each tree if it is dead
      (1) or not (NA).</p></li>
</ul><p></p></dd>


  <dt id="arg-plot-design">plot.design<a class="anchor" aria-label="anchor" href="#arg-plot-design"></a></dt>
<dd><p>Vector containing the plot designs considered. By default, all plot designs will be considered (circular fixed area, k-tree and angle-count plots).</p></dd>


  <dt id="arg-plot-parameters">plot.parameters<a class="anchor" aria-label="anchor" href="#arg-plot-parameters"></a></dt>
<dd><p>Data frame containing parameters for circular fixed area, k-tree and angle-count plot designs. If there is a <code>stratum</code> column in the <code>tree.list.tls</code> argument, it must have the same number of rows as strata values and they must be named using strata encoding. If plot parameters are not specified, the corresponding plot designs will not be considered in the function. If no parameter is specified, the function will stop giving an error message! The parameters are as follows:</p></dd>


  </dl><ul><li><p><code>radius</code>: plot radius (m) considered for circular fixed area plots. Absence of this argument rules out this plot design.</p></li>
<li><p><code>k.tree</code>: number of trees (trees) considered for k-tree plots. Absence of this argument rules out this plot design.</p></li>
<li><p><code>BAF</code>: basal area factor (\({m}^{2}/ha\)) considered for angle-count plots. Absence of this argument rules out this plot design.</p></li>
<li><p><code>num.trees</code>: number of dominant trees per ha (tree/ha), i.e. those with largest <em>dbh</em>, considered for calculating dominant diameters and heights. In the absence of this argument, the number will be assumed to be 100 trees/ha.</p></li>
</ul><p></p>
<dl><dt id="arg-scan-approach">scan.approach<a class="anchor" aria-label="anchor" href="#arg-scan-approach"></a></dt>
<dd><p>Character parameter indicating TLS single-scan (‘single’) or TLS multi-scan approach or SLAM point clouds (‘multi’) approaches. If this argument is not specified by the user, it will be set to ‘multi’ approach.</p></dd>


  <dt id="arg-var-metr">var.metr<a class="anchor" aria-label="anchor" href="#arg-var-metr"></a></dt>
<dd><p>Optional vector containing all the metrics and variables of interest. By default it will be set as NULL and thus, all the metrics and variables available will be generated.</p></dd>


  <dt id="arg-v-calc">v.calc<a class="anchor" aria-label="anchor" href="#arg-v-calc"></a></dt>
<dd><p>Optional parameter to calculate volume when is not included in tree.tls input data.</p></dd>


  <dt id="arg-dbh-min">dbh.min<a class="anchor" aria-label="anchor" href="#arg-dbh-min"></a></dt>
<dd><p>Optional minimum <em>dbh</em> (cm) considered for detecting trees. By default it will be set at 4 cm.</p></dd>


  <dt id="arg-h-min">h.min<a class="anchor" aria-label="anchor" href="#arg-h-min"></a></dt>
<dd><p>Optional minimum <em>h</em> (m) considered for detecting trees. By default it will be set at 1.3 m.</p></dd>


  <dt id="arg-max-dist">max.dist<a class="anchor" aria-label="anchor" href="#arg-max-dist"></a></dt>
<dd><p>Optional argument to specify the maximum horizontal distance considered in which trees will be included.</p></dd>


  <dt id="arg-dir-data">dir.data<a class="anchor" aria-label="anchor" href="#arg-dir-data"></a></dt>
<dd><p>Optional character string naming the absolute path of the directory where TXT
  files containing TLS point clouds are located. <code>.Platform$file.sep</code> must
  be used as the path separator in <code>dir.data</code>, and TXT files in the
  directory must have the same description and format as indicated for TXT
  files in <code><a href="normalize.html">normalize</a></code> ‘Output Files’. If this
  argument is not specified by the user, it will be set to <code>NULL</code> by default
  and, as consequence, the current working directory of the <span style="R">R</span> process will be
  assigned to <code>dir.dat</code> during the execution.</p></dd>


  <dt id="arg-save-result">save.result<a class="anchor" aria-label="anchor" href="#arg-save-result"></a></dt>
<dd><p>Optional logical which indicates whether or not the output files described in ‘Output Files’ section must be saved in <code>dir.result</code>. If this argument is not specified by the user, it will be set to <code>TRUE</code> by default and, as consequence, the output files will be saved.</p></dd>


  <dt id="arg-dir-result">dir.result<a class="anchor" aria-label="anchor" href="#arg-dir-result"></a></dt>
<dd><p>Optional character string naming the absolute path of an existing directory where files described in ‘Output Files’ section will be saved. <code>.Platform$file.sep</code> must be used as the path separator in <code>dir.result</code>. If this argument is not specified by the user, and <code>save.result</code> is <code>TRUE</code>, it will be set to <code>NULL</code> by default and, as a consequence, the current working directory of the <span style="R">R</span> process will be assigned to <code>dir.result</code> during the execution.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function also works for several plots. In this case, a column named "id" to identify plots (string character or numeric) must be included in the <code>tree.list.tls</code> database argument. This must coincide with the corresponding "id" assigned in <code><a href="normalize.html">normalize</a></code> to TXT files saved in <code>dir.data</code> (for more details see <code><a href="normalize.html">normalize</a></code>). In addition, if there are several strata, they can be processed separately according to <code>plot.parameters</code> values (where each row will represent one stratum). If <code>tree.list.tls</code> does not include a specific "stratum" column, it will be assumed to have only one stratum, which will be encoded according to <code>rownames(plot.parameters)[1]</code>.</p>
<p>Using TLS data, this function computes metrics and estimations of variables (see ‘Value’) for plot design specified in the <code>plot.parameters</code> argument. The notation used for variables is based on IUFRO (1959).</p>
<p>At this stage, three plot designs are available:</p>
<ul><li><p>Circular fixed area plots, simulated only if a <code>radius</code> value is
    specified in the <code>plot.parameters</code> argument.</p></li>
<li><p>k-tree plots, simulated only if a <code>k.tree</code> value is
    specified in the <code>plot.parameters</code> argument.</p></li>
<li><p>Angle-count plots, simulated only if a <code>BAF</code> value is
    specified in the <code>plot.parameters</code> argument.</p></li>
</ul><p>Volume is estimated modelling stem profile as a paraboloid and calculating the volumes of revolution; where trees <em>dbh</em> are estimated in <code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code> and <code><a href="tree.detection.multi.scan.html">tree.detection.multi.scan</a></code>, and total heights are estimated as percentile 99 of z coordinate of points delimited by Voronoi polygons.</p>
<p>Regarding occlusion corrections for estimating variables, apart from distance sampling methods considered in <code><a href="distance.sampling.html">distance.sampling</a></code>, another occlusion corection based on correcting the shadowing effect (Seidel &amp; Ammer, 2014) has been included to estimate some variables in circular fixed area and k-tree plots. In the case of angle-count plots, occlusion corrections are based on gap probability attenuation with distance to TLS depending on Poisson model (Strahler et al., 2008; Lovell et al., 2011).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List including TLS-based metrics and variables computed for plot designs considered. The list will contain one element per plot design considered (fixed.area.plot, k.tree.plot and angle.count.plot):</p>
<dl><dt>fixed.area.plot</dt>
<dd><p>If no value for <code>plot.radius</code> is specified in the <code>plot.parameters</code> argument, <code>NULL</code>; otherwise, the data frame will include TLS metrics and variables estimated in a circular fixed area plot design (rows represent simulations). The data frame will have the following columns:</p>
<p>Stratum, plot identification and radius:</p><ul><li><p><code>stratum</code>: stratum identification encoded as a character string or
      numeric. It must coincide with those included in the <code>stratum</code> column of <code>tree.list.tls</code>.</p></li>
<li><p><code>id</code>: plot identification encoded as character string or
      numeric. It will coincide with those included in the <code>id</code>
      column of <code>tree.list.tls</code> and, if applicable, the
      <code>distance.sampling</code> argument.</p></li>
<li><p><code>radius</code>: radius (m) of the simulated plot.</p></li>
</ul><p>Terrestrial-Based Technologies variables:</p>
<p></p><ul><li><p><code>N.tls</code>: stand density (trees/ha) without occlusion
      corrections.</p></li>
<li><p><code>N.hn</code>, <code>N.hr</code>, <code>N.hn.cov</code>, <code>N.hr.cov</code>: stand
      density (trees/ha) with occlusion corrections based on distance sampling
      methodologies (see <code><a href="distance.sampling.html">distance.sampling</a></code>). These columns will not appear if the <code>distance.sampling</code>
      argument is <code>NULL</code>.</p></li>
<li><p><code>N.sh</code>: stand density (trees/ha) with correction of the
      shadowing effect.
      respectively).</p></li>
<li><p><code>G.tls</code>: stand basal area (\({m}^{2}/ha\)) without occlusion
      corrections.</p></li>
<li><p><code>G.hn</code>, <code>G.hr</code>, <code>G.hn.cov</code>, <code>G.hr.cov</code>: stand
      basal area (\({m}^{2}/ha\)) with occlusion corrections based on distance sampling
      methodologies (see <code><a href="distance.sampling.html">distance.sampling</a></code>). These columns are missing if <code>distance.sampling</code>
      argument is <code>NULL</code>.</p></li>
<li><p><code>G.sh</code>: stand basal area (\({m}^{2}/ha\)) with correction of the
      shadowing effect.</p></li>
<li><p><code>V.tls</code>: stand volume (\({m}^{3}/ha\)) without occlusion corrections.</p></li>
<li><p><code>V.hn</code>, <code>V.hr</code>, <code>V.hn.cov</code>, <code>V.hr.cov</code>: stand
      volume (\({m}^{3}/ha\)) with occlusion corrections based on distance sampling
      methodologies (see <code><a href="distance.sampling.html">distance.sampling</a></code>). These  columns will be missing if the <code>distance.sampling</code>
      argument is <code>NULL</code>.</p></li>
<li><p><code>V.sh</code>: stand volume (\({m}^{3}/ha\)) with correction of the
      shadowing effect.</p></li>
<li><p><code>d.tls</code>, <code>dg.tls</code>, <code>dgeom.tls</code>, <code>dharm.tls</code>:
      mean tree diameters (cm) at breast height (1.3 m), calculated from the arithmetic mean,
      quadratic mean, geometric mean and harmonic mean, respectively.</p></li>
<li><p><code>h.tls</code>, <code>hg.tls</code>, <code>hgeom.tls</code>, <code>hharm.tls</code>:
      mean tree heights (m), calculated from the arithmetic mean, quadratic mean, geometric
      mean and harmonic mean, respectively.</p></li>
<li><p><code>d.0.tls</code>, <code>dg.0.tls</code>, <code>dgeom.0.tls</code>,
      <code>dharm.0.tls</code>: dominant mean tree diameters (cm) at breast height
      (1.3 m), calculated from the arithmetic mean, quadratic mean, geometric mean and
      harmonic mean, respectively.</p></li>
<li><p><code>h.0.tls</code>, <code>hg.0.tls</code>, <code>hgeom.0.tls</code>,
      <code>hharm.0.tls</code>: dominant mean tree heights (m), calculated from the arithmetic
      mean, quadratic mean, geometric mean and harmonic mean, respectively.</p></li>
</ul><p>Terrestrial-Based Technologies metrics:</p>
<p></p><ul><li><p><code>n.pts</code>, <code>n.pts.est</code>, <code>n.pts.red</code>, <code>n.pts.red.est</code>: number of points and estimated number of
      points (points) belonging to trees normal sections (+/- 5 cm) in the
      original point cloud (<code>n.pts</code> and <code>n.pts.est</code>,
      respectively); and number of points and estimated number of points
      (points) belonging to trees normal sections (+/- 5 cm) in the reduced
      point cloud (<code>n.pts.red</code> and <code>n.pts.red.est</code>,
      respectively).</p></li>
<li><p><code>P01</code>, <code>P05</code>, <code>P10</code>, <code>P20</code>, <code>P25</code>,
      <code>P30</code>, <code>P40</code>, <code>P50</code>, <code>P60</code>, <code>P70</code>, <code>P75</code>,
      <code>P80</code>, <code>P90</code>, <code>P95</code>, <code>P99</code>: height percentiles
      derived from z coordinates of TLS point clouds relative to ground level (m).</p></li>
<li><p><code>mean.arit.z/rho/phi</code>, <code>mean.qua.z/rho/phi</code>, <code>mean.geom.z/rho/phi</code>, <code>mean.harm.z/rho/phi</code>, <code>median.z/rho/phi</code>, <code>mode.z/rho/phi</code>: central tendency statistics for z, rho (horizontal distance) and r (euclidean distance) coordinates (arithmetic, quadratic, geometrical and harmonic means, median and mode, respectively).</p></li>
<li><p><code>var.z/rho/phi</code>, <code>sd.z/rho/phi</code>, <code>CV.z/rho/phi</code>, <code>D.z/rho/phi</code>, <code>ID.z/rho/phi</code>, <code>max.z/rho/phi</code>, <code>min.z/rho/phi</code>: dispersion tendency statistics for z, rho and r coordinates (variance, standar deviation, coefficient of variation, range, interquartile range, maximum and minimum, respectively).</p></li>
<li><p><code>kurt.z/rho/phi</code>, <code>skw.z/rho/phi</code>: curtosis and skewness, respectively.</p></li>
<li><p><code>L1.z/rho/phi</code>, <code>L2.z/rho/phi</code>, <code>L3.z/rho/phi</code>, <code>L4.z/rho/phi</code>, <code>L-CV.z/rho/phi</code>, <code>MAD-median.z/rho/phi</code>, <code>MAD-mode.z/rho/phi</code>: L-moments of order 2, 3 and 4, median of the absolute deviations from the overall median and mode of the absolute deviations from the overall mode, respectively.</p></li>
<li><p><code>L3.mu.z/rho/phi</code>, <code>L4.mu.z/rho/phi</code>: third and fourth central moments, respectively.</p></li>
<li><p><code>PA.2m</code>, <code>PA.mean.z</code>, <code>PA.mode.z</code>: percentage of laser returns above 2 m, mean and mode, respectively.</p></li>
<li><p><code>PB.2m</code>, <code>PB.mean.z</code>, <code>PB.median.z</code>, <code>PB.mode.z</code>: percentage of laser returns below 2 m, mean and mode, respectively.</p></li>
<li><p><code>weibull.b.z/rho/phi</code>, <code>weibull.c.z/rho/phi</code>: scale and shape parameters, respectively, for Weibull distribution fitted for z coordinates of TLS point clouds relative to ground level.</p></li>
</ul></dd>



<dt>k.tree.plot</dt>
<dd><p>If no value for <code>k.tree</code> is specified in the <code>plot.parameters</code> argument, <code>NULL</code>; otherwise, the data frame will include TLS metrics and variables estimated in the k-tree plot design (rows represent simulations). The data frame will include the following columns (same description and format as indicated in <code>fixed.area.plot</code> element):</p>
<p>Stratum, plot identification and k:</p><ul><li><p><code>stratum</code>: stratum identification encoded as character string or
      numeric. It must coincide with those included in the <code>stratum</code> column of <code>tree.list.tls</code>.</p></li>
<li><p><code>id</code>: plot identification encoded as character string or numeric value. It will coincide with those included in <code>id</code>
      column of <code>tree.list.tls</code> or, if applicable, the
      <code>distance.sampling</code> argument.</p></li>
<li><p><code>k</code>: number of trees in the simulated plot.</p></li>
</ul><p>Terrestrial-Based Technologies variables:</p><ul><li><p><code>N.tls</code>, <code>N.hn</code>, <code>N.hr</code>, <code>N.hn.cov</code>,
      <code>N.hr.cov</code>, <code>N.sh</code>, <br><code>G.tls</code>, <code>G.hn</code>, <code>G.hr</code>, <code>G.hn.cov</code>, <code>G.hr.cov</code>,
      <code>G.sh</code>, <br><code>V.tls</code>, <code>V.hn</code>, <code>V.hr</code>, <code>V.hn.cov</code>,
      <code>V.hr.cov</code>, <code>V.sh</code>, <br><code>d.tls</code>, <code>dg.tls</code>,
      <code>dgeom.tls</code>, <code>dharm.tls</code>, <br><code>h.tls</code>, <code>hg.tls</code>,
      <code>hgeom.tls</code>, <code>hharm.tls</code>, <br><code>d.0.tls</code>, <code>dg.0.tls</code>,
      <code>dgeom.0.tls</code>, <code>dharm.0.tls</code>, <br><code>h.0.tls</code>, <code>hg.0.tls</code>,
      <code>hgeom.0.tls</code>, <code>hharm.0.tls</code></p></li>
</ul><p>Terrestrial-Based Technologies metrics:</p><ul><li><p><code>num.points</code>,
      <code>num.points.est</code>, <code>num.points.hom</code>, <code>num.points.hom.est</code>, <br><code>P01</code>,<code>P05</code>,
      <code>P10</code>, <code>P20</code>, <code>P25</code>, <code>P30</code>, <code>P40</code>, <code>P50</code>,
      <code>P60</code>, <code>P70</code>, <code>P75</code>, <code>P80</code>, <code>P90</code>, <code>P95</code>,
      <code>P99</code>: same description and format
as indicated in fixed.area.plot element.</p></li>
</ul></dd>



<dt>angle.count.plot</dt>
<dd><p>If no value for <code>BAF</code> is specified in the <code>plot.parameters</code> argument, <code>NULL</code>; otherwise, the data frame will include TLS metrics and variables estimated in the angle-count plot design (rows represent simulations). The data frame will include the following columns:</p>
<p>Stratum, plot identification and BAF:</p><ul><li><p><code>stratum</code>: stratum identification encoded as character string or
      numeric. It must coincide with those included in <code>stratum</code> column of <code>tree.list.tls</code>.</p></li>
<li><p><code>id</code>: plot identification encoded as character string or numeric. It will coincide with those included in the <code>id</code> column of <code>tree.list.tls</code>.</p></li>
<li><p><code>BAF</code>: BAF (\({m}^{2}/ha\)) of the simulated plot.</p></li>
</ul><p>Terrestrial-Based Technologies variables:</p><ul><li><p><code>N.tls</code>: same description and format as indicated in the
      <code>fixed.area.plot</code> element.</p></li>
<li><p><code>N.pam</code>: stand density (trees/ha) with occlusion correction
      based on gap probability attenuation with distance to TLS.
      <code>fixed.area.plot</code> element.</p></li>
<li><p><code>G.tls</code>: same description and format as indicated for the
      <code>fixed.area.plot</code> element.</p></li>
<li><p><code>G.pam</code>: stand basal area (\({m}^{2}/ha\)) with occlusion correction
      based on gap probability attenuation with distance from TLS.</p></li>
<li><p><code>V.tls</code>: same description and format as indicated for the
      <code>fixed.area.plot</code> element.</p></li>
<li><p><code>V.pam</code>: stand volume (\({m}^{3}/ha\)) with occlusion correction based
      on gap probability attenuation with distance from TLS.</p></li>
<li><p><code>d.tls</code>, <code>dg.tls</code>, <code>dgeom.tls</code>, <code>dharm.tls</code>, <br><code>h.tls</code>, <code>hg.tls</code>, <code>hgeom.tls</code>, <code>hharm.tls</code>, <br><code>d.0.tls</code>, <code>dg.0.tls</code>, <code>dgeom.0.tls</code>, <code>dharm.0.tls</code>, <br><code>h.0.tls</code>, <code>hg.0.tls</code>, <code>hgeom.0.tls</code>, <code>hharm.0.tls</code></p></li>
</ul><p>Terrestrial-Based Technologies metrics:</p><ul><li><p><code>num.points</code>, <code>num.points.est</code>, <code>num.points.hom</code>,
      <code>num.points.hom.est</code>, <br><code>P01</code>, <code>P05</code>, <code>P10</code>, <code>P20</code>, <code>P25</code>, <code>P30</code>,
      <code>P40</code>, <code>P50</code>, <code>P60</code>, <code>P70</code>, <code>P75</code>, <code>P80</code>,
      <code>P90</code>, <code>P95</code>, <code>P99</code>: same description and format as
      indicated for the <code>fixed.area.plot</code> element.</p></li>
</ul></dd>
</dl></div>
    <div class="section level2">
    <h2 id="output-files">Output Files<a class="anchor" aria-label="anchor" href="#output-files"></a></h2>


<p>After computing metrics and variables, if the <code>save.result</code> argument is <code>TRUE</code>, the function will save the elements in the list described in ‘Value’ (<code>fixed.area.plot</code>, <code>k.tree.plot</code> and <code>angle.count.plot</code>), which are different from <code>NULL</code> as CSV files.  Data frames are written without row names in the <code>dir.result</code> directory by using <code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></code> function from the <span class="pkg">utils</span> package. The pattern used for naming these files is ‘metrics.variables.&lt;plot design&gt;.csv’,
being ‘&lt;plot design&gt;’ equal to “fixed.area.plot”, “k.tree.plot” or “angle.count.plot”
according to the plot design.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>


<p>In order to optimize plot designs and, therefore, for better use of <code>metrics.variables</code>, other functions such as <code><a href="correlations.html">correlations</a></code>, <code><a href="relative.bias.html">relative.bias</a></code> and <code><a href="estimation.plot.size.html">estimation.plot.size</a></code> should be used.</p>
<p>This function will be updated as new metrics are developed.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>IUFRO (1959). Standarization of symbols in forest mensuration. Vienna, Austria, IUFRO.</p>
<p>Lovell, J. L., Jupp, D. L. B., Newnham, G. J., &amp; Culvenor, D. S. (2011). Measuring tree stem diameters using intensity profiles from ground-based scanning lidar from a fixed viewpoint. <em>ISPRS Journal of Photogrammetry and Remote Sensing</em>, <b>66(1)</b>, 46-55. <a href="https://doi.org/10.1016/j.isprsjprs.2010.08.006" class="external-link">doi:10.1016/j.isprsjprs.2010.08.006</a></p>
<p>Seidel, D., &amp; Ammer, C. (2014). Efficient measurements of basal area in short rotation forests based on terrestrial laser scanning under special consideration of shadowing. <em>iForest-Biogeosciences and Forestry</em>, <b>7(4)</b>, 227. <a href="https://doi.org/10.3832/ifor1084-007" class="external-link">doi:10.3832/ifor1084-007</a></p>
<p>Strahler, A. H., Jupp, D. L. B., Woodcock, C. E., Schaaf, C. B., Yao, T., Zhao,
F., Yang, X., Lovell, J., Culvenor, D., Newnham, G., Ni-Miester, W., &amp;
Boykin-Morris, W. (2008). Retrieval of forest structural parameters using a
ground-based lidar instrument (Echidna®). <em>Canadian Journal of Remote
Sensing</em>, <b>34(sup2)</b>, S426-S440. <a href="https://doi.org/10.5589/m08-046" class="external-link">doi:10.5589/m08-046</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Juan Alberto Molina-Valero,
Adela Martínez-Calvo.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code>, <code><a href="tree.detection.multi.scan.html">tree.detection.multi.scan</a></code>, <code><a href="tree.detection.several.plots.html">tree.detection.several.plots</a></code>, <code><a href="distance.sampling.html">distance.sampling</a></code>,
<code><a href="normalize.html">normalize</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Establishment of working directories (optional)</span></span></span>
<span class="r-in"><span><span class="co"># By default here we propose the current working directory of the R process</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dir.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dir.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Loading example data included in FORTLS</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Rioja.data"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree.tls</span> <span class="op">&lt;-</span> <span class="va">Rioja.data</span><span class="op">$</span><span class="va">tree.tls</span></span></span>
<span class="r-in"><span><span class="va">tree.tls</span> <span class="op">&lt;-</span> <span class="va">tree.tls</span><span class="op">[</span><span class="va">tree.tls</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="st">"1"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Download example of TXT file corresponding to plot 1 from Rioja data set</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://www.dropbox.com/s/w4fgcyezr2olj9m/Rioja_1.txt?dl=1"</span>,</span></span>
<span class="r-in"><span>              destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir.data</span>, <span class="st">"1.txt"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>downloaded length 198983068 != reported length 240319350</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>URL 'https://uc15c100ff501a7e9cc3a62fe8d0.dl.dropboxusercontent.com/cd/0/get/CzH8-185R6x-GF6C-K_7QUi1vFZzr-7ZPYWYb-gNUuMXoesZC4AmXkV0XomdTzaGic5M2NEEgnPW9iZK_MRwvrjc0p4W49qeOkKJxG3O_z7JZ0YXsZmP9fjMqtTdMb9SK_-lqnEShzIVkSw4MWxTQHAr/file?dl=1': Timeout of 60 seconds was reached</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in download.file(url = "https://www.dropbox.com/s/w4fgcyezr2olj9m/Rioja_1.txt?dl=1",     destfile = file.path(dir.data, "1.txt"), mode = "wb"):</span> download from 'https://www.dropbox.com/s/w4fgcyezr2olj9m/Rioja_1.txt?dl=1' failed</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Considering distance sampling methods (only for single-scan approaches)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ds &lt;- distance.sampling(tree.tls)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">met.var.TLS</span> <span class="op">&lt;-</span> <span class="fu">metrics.variables</span><span class="op">(</span>tree.tls <span class="op">=</span> <span class="va">tree.tls</span>,</span></span>
<span class="r-in"><span>                                 <span class="co"># tree.ds = ds,</span></span></span>
<span class="r-in"><span>                                 plot.parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="fl">10</span>, BAF <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 dir.data <span class="op">=</span> <span class="va">dir.data</span>, dir.result <span class="op">=</span> <span class="va">dir.result</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing metrics for plot: '1'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  (21.32 secs)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juan Alberto Molina-Valero, Adela Martínez-Calvo, María José Ginzo Villamayor, Juan Gabriel Álvarez-González, Fernando Montes, César Pérez-Cruzado.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Computes TLS metrics derived from simulated TLS plots and variables estimated on the basis of simulated field plots. Real TLS and field data from the same
set of plots are required in order to build simulated plots. Three different
plot designs are currently available: circular fixed area, k-tree and angle-count.
During the simulation process, plots with incremental values for radius, k and
BAF are simulated for circular fixed area, k-tree and angle-count designs, respectively,
according to the parameters specified in the plot.parameters argument. For
TLS metrics, different method are included for correcting occlusions generated in
TLS point clouds."><title>Compute Metrics and Variables for Simulated TLS and Field Plots — simulations • FORTLS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Metrics and Variables for Simulated TLS and Field Plots — simulations"><meta property="og:description" content="Computes TLS metrics derived from simulated TLS plots and variables estimated on the basis of simulated field plots. Real TLS and field data from the same
set of plots are required in order to build simulated plots. Three different
plot designs are currently available: circular fixed area, k-tree and angle-count.
During the simulation process, plots with incremental values for radius, k and
BAF are simulated for circular fixed area, k-tree and angle-count designs, respectively,
according to the parameters specified in the plot.parameters argument. For
TLS metrics, different method are included for correcting occlusions generated in
TLS point clouds."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">FORTLS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/plot_design_optimization.html">Plot design optimization</a>
    <a class="dropdown-item" href="../articles/stand_level.html">Stand-level</a>
    <a class="dropdown-item" href="../articles/tree_level.html">Tree-level</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Molina-Valero/FORTLS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute Metrics and Variables for Simulated TLS and Field Plots</h1>
      
      <div class="d-none name"><code>simulations.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes TLS metrics derived from simulated TLS plots and variables estimated on the basis of simulated field plots. Real TLS and field data from the same
set of plots are required in order to build simulated plots. Three different
plot designs are currently available: circular fixed area, k-tree and angle-count.
During the simulation process, plots with incremental values for radius, k and
BAF are simulated for circular fixed area, k-tree and angle-count designs, respectively,
according to the parameters specified in the <code>plot.parameters</code> argument. For
TLS metrics, different method are included for correcting occlusions generated in
TLS point clouds.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">simulations</span><span class="op">(</span><span class="va">tree.tls</span>, tree.ds <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">tree.field</span>,
            plot.design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fixed.area"</span>, <span class="st">"k.tree"</span>, <span class="st">"angle.count"</span><span class="op">)</span>,
            plot.parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>radius.max <span class="op">=</span> <span class="fl">25</span>, k.max <span class="op">=</span> <span class="fl">50</span>, BAF.max <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
            scan.approach <span class="op">=</span> <span class="st">"single"</span>, var.metr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tls <span class="op">=</span> <span class="cn">NULL</span>, field <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,
            dbh.min <span class="op">=</span> <span class="fl">4</span>, h.min <span class="op">=</span> <span class="fl">1.3</span>, max.dist <span class="op">=</span> <span class="cn">Inf</span>,
            dir.data <span class="op">=</span> <span class="cn">NULL</span>, save.result <span class="op">=</span> <span class="cn">TRUE</span>, dir.result <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tree.tls</dt>
<dd><p>Data frame with information about trees detected from TLS point cloud data. The
  structure and format must be analogous to output  returned by
  <code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code> and <code><a href="tree.detection.multi.scan.html">tree.detection.multi.scan</a></code> (or <code><a href="tree.detection.several.plots.html">tree.detection.several.plots</a></code>) functions. In particular, each row must
  correspond to a (plot, tree) pair, and it must include at least the following columns:</p><ul><li><p><code>id</code>, <code>file</code>, <code>tree</code>, <code>x</code>, <code>y</code>,
      <code>phi.left</code>, <code>phi.right</code>, <code>horizontal.distance</code>,
      <code>dbh</code>, <code>num.points</code>, <code>num.points.hom</code>,
      <code>num.points.est</code>, <code>num.points.hom.est</code>,
      <code>partial.occlusion</code>: same description and format as indicated for the
      same named columns in <code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code> ‘Value’.</p></li>
</ul><p></p></dd>


  <dt>tree.ds</dt>
<dd><p>An optional list containing results arises from the application of distance
  sampling methodologies. The structure and format must be analogous to output
  returned by <code><a href="distance.sampling.html">distance.sampling</a></code> function. In particular, it must
  include at least the following elements:</p><ul><li><p><code>tree</code>: data frame with detection probabilities for each tree
      using distance sampling methodologies. Each row must correspond
      to a (plot, tree) pair, and it must include at least the following columns:</p><ul><li><p><code>id</code>, <code>tree</code>, <code>P.hn</code>, <code>P.hn.cov</code>,
          <code>P.hr</code>, <code>P.hr.cov</code>: same description and format as
          indicated for same named columns of <code>tree</code> in <code><a href="distance.sampling.html">distance.sampling</a></code> ‘Value’. In addition, plot
          identification and tree numbering included in <code>id</code> and
          <code>tree</code> columns must coincide with those included in the same
          named columns of <code>tree.tls</code> argument.</p></li>
</ul><p>If this argument is not specified by the user, it will be set to <code>NULL</code> by
  default and, as a consequence, the TLS metrics using distance sampling based
  correction will not be calculated for a circular fixed area or k-tree plot designs.</p></li>
</ul></dd>


  <dt>tree.field</dt>
<dd><p>Data frame with information about trees measured in the field plots. Each
  row must correspond to a (plot, tree) pair, and it must include at least the
  following columns:</p><ul><li><p><code>id</code>: plot identification encoded as character string or
      numeric. Plot identifications must coincide with those
      included in <code>id</code> column of the <code>tree.tls</code> argument.</p></li>
<li><p><code>tree</code>: trees numbering.</p></li>
<li><p><code>horizontal.distance</code>: horizontal distance (m) from plot
      centre to tree centre. Centres of the field plots must coincide with
      centres of their corresponding TLS plots.</p></li>
<li><p><code>dbh</code>: tree diameter (cm) at breast height (1.3 m).</p></li>
<li><p><code>total.height</code>: tree total height (m).</p></li>
<li><p><code>dead</code>: integer value indicating for each tree if it is dead
      (1) or not (NA).</p></li>
</ul><p></p></dd>


  <dt>plot.design</dt>
<dd><p>Vector containing the plot designs considered. By default, all plot designs will be considered (circular fixed area, k-tree and angle-count plots).</p></dd>


  <dt>plot.parameters</dt>
<dd><p>Optional list containing parameters for circular fixed area, k-tree and angle-count
  plot designs. User can set all or any of the following parameters specifying
  them as named elements of the list:</p><ul><li><p><code>radius.max</code>: maximum radius (m) allowed for the increasing
      sequence of radius values to be used in the simulation process of TLS and
      field plots under circular fixed area plot design. If this element is not included
      in the argument, circular fixed area plots will not be simulated.</p></li>
<li><p><code>radius.increment</code>: positive increment (m) for the increasing
      sequence of radius values to be used in the simulation process of TLS and
      field plots in a circular fixed area plot design. If this element is not included
      in the argument, it is set to 0.1 m by default.</p></li>
<li><p><code>k.tree.max</code>: maximum number of trees (trees) allowed for the
      increasing sequence of k values to be used in the simulation process of
      TLS and field plots under k-tree plot design. If this element is not
      included in the argument, k-tree plots will not be simulated.</p></li>
<li><p><code>BAF.max</code>: maximum BAF (\({m}^{2}/ha\)) allowed for the increasing
      sequence of BAF values to be used in the simulation process of TLS and
      field plots in an angle-count plot design. If this element is not
      included in the argument, angle-count plots will not be simulated.</p></li>
<li><p><code>BAF.increment</code>: positive increment (\({m}^{2}/ha\)) for the increasing
      sequence of BAF values to be used in the simulation process of TLS and
      field plots under angle-count plot design. If this element is not
      included in the argument, it is set to 0.1 \({m}^{2}/ha\) by default.</p></li>
<li><p><code>num.trees</code>: number of dominant trees per ha (tree/ha) to be
      used for calculating dominant diameters and heights during the simulation
      process of TLS and field plots under all the available plot designs.
      Dominant trees are those with the largest diameter at breast height. If
      this element is not included in <code>plot.parameters</code> argument, it is
      set to 100 trees/ha by default.</p></li>
</ul><p>If this argument is specified by the user, it must include at least one of
  the following elements: <code>radius.max</code>, <code>k.tree.max</code> or
  <code>BAF.max</code>. If this argument is not specified by the user, it is set to
  <code>list(radius.max = 25, k.tree.max = 50, BAF.max = 4)</code> by default and, as a
  consequence, the three available plot designs will be simulated.</p></dd>


  <dt>scan.approach</dt>
<dd><p>Character parameter indicating TLS single-scan (‘single’) or TLS multi-scan approach or SLAM point clouds (‘multi’) approaches. If this argument is not specified by the user, it will be set to ‘multi’ approach.</p></dd>


    <dt>var.metr</dt>
<dd><p>Optional vector containing all the metrics and variables of interest. By default it will be set as NULL and thus, all the metrics and variables available will be generated.</p></dd>


    <dt>dbh.min</dt>
<dd><p>Optional minimum <em>dbh</em> (cm) considered for detecting trees. By default it will be set at 4 cm.</p></dd>


  <dt>h.min</dt>
<dd><p>Optional minimum <em>h</em> (m) considered for detecting trees. By default it will be set at 1.3 m.</p></dd>


  <dt>max.dist</dt>
<dd><p>Optional argument to specify the maximum horizontal distance considered in which trees will be included.</p></dd>


  <dt>dir.data</dt>
<dd><p>Optional character string naming the absolute path of the directory where TXT
  files containing TLS point clouds are located. <code>.Platform$file.sep</code> must
  be used as the path separator in <code>dir.dat</code>, and TXT files in the
  directory must have the same description and format as indicated for TXT
  files in <code><a href="normalize.html">normalize</a></code> ‘Output Files’. If this
  argument is not specified by the user, it will be set to <code>NULL</code> by default
  and, as a consequence, the current working directory of the <span style="R">R</span> process will be
  assigned to <code>dir.dat</code> during the execution.</p></dd>


  <dt>save.result</dt>
<dd><p>Optional logical which indicates wheter or not the output files described in
  ‘Output Files’ section must be saved in <code>dir.result</code>. If
  this argument is not specified by the user, it will be set to <code>TRUE</code> by
  default and, as a consequence, the output files are saved.</p></dd>


  <dt>dir.result</dt>
<dd><p>Optional character string naming the absolute path of an existing directory
  where files described in ‘Output Files’ section will be saved.
  <code>.Platform$file.sep</code> must be used as the path separator in
  <code>dir.result</code>. If this argument is not specified by the user, and
  <code>save.result</code> is <code>TRUE</code>, it will be set to <code>NULL</code> by default and,
  as a consequence, the current working directory of the <span style="R">R</span> process will be
  assigned to <code>dir.result</code> during the execution.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Using real TLS and field data from the same set of plots, this function enables construction
of simulated plots under different plot designs and computation of the
corresponding TLS metrics and estimated variables. The notation used for
variables is based on IUFRO (1959).</p>
<p>At this stage, three plot designs are available:</p><ul><li><p>Circular fixed area plots, simulated only if a <code>radius.max</code> value is
    specified in the <code>plot.parameters</code> argument.</p></li>
<li><p>k-tree plots, simulated only if a <code>k.tree.max</code> value is
    specified in the <code>plot.parameters</code> argument.</p></li>
<li><p>Angle-count plots, simulated only if a <code>BAF.max</code> value is
    specified in the <code>plot.parameters</code> argument.</p></li>
</ul><p>For each real plot, a simulation process is run under each of the plot designs
specified by means of elements of the <code>plot.parameters</code> argument. Although there
are some minor differences depending on the plot design, the rough outline of
the simulation process is similar for all, and it consists of the
following main steps:</p><ol><li><p>Define an increasing sequence of the plot design parameter (radius,
    k or BAF) according to the maximum value and, if applicable, the positive
    increment set in <code>plot.parameters</code> argument.</p></li>
<li><p>Build simulated plots for each parameter value in the previous
    sequence based on either TLS or field data.</p></li>
<li><p>Compute either TLS metrics or variables estimated on the basis of
    simulated plots for each parameter value (see ‘Value’ section for
    details). For the simulated TLS plots, note that in
    addition to the counterparts of variables computed for the simulated field
    plots, the function also computes the following:</p><ul><li><p>Metrics related to the number of points belonging to normal tree
        sections.</p></li>
<li><p>Metrics with occlusion corrections based on the following:</p><ul><li><p>Distance sampling methodologies (Astrup et al., 2014) for
          circular fixed area and k-tree plot designs, if the <code>distance.sampling</code>
          argument is not <code>NULL</code>.</p></li>
<li><p>Correction of the shadowing effect (Seidel &amp; Ammer, 2014) for
          circular fixed area and k-tree plot designs.</p></li>
<li><p>Gap probability attenuation with distance to TLS (Strahler et
          al., 2008; Lovell et al., 2011) for angle-count plot design.</p></li>
</ul></li>
<li><p>Height percentiles derived from z coordinates of TLS point clouds
         relative to ground level.</p></li>
</ul></li>
</ol></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with field estimates and TLS metrics for plot designs considered. It will contain one element per plot design considered (fixed.area.plot, k.tree.plot and angle.count.plot)</p>
<dl><dt>fixed.area.plot</dt>
<dd><p>If no value for <code>radius.max</code> is specified in the <code>plot.parameters</code>
  argument, <code>NULL</code>; otherwise, data frame with TLS metrics and variables will be estiamted on the basis of simulated plots in a circular fixed area plot design. Each row will correspond to a (plot, radius) pair, and the
  following columns will be included:</p>
<p>Plot identification and radius:</p><ul><li><p><code>id</code>: plot identification encoded as a character string or
      numeric. It will coincide with those included in the <code>id</code>
      column of <code>tree.tls</code>, <code>tree.field</code> or, if applicable,
      <code>distance.sampling</code> arguments.</p></li>
<li><p><code>radius</code>: radius (m) of the simulated plot.</p></li>
</ul><p>Variables estimated on the basis of simulated field plots:</p><ul><li><p><code>N</code>: stand density (trees/ha).</p></li>
<li><p><code>G</code>: stand basal area (\({m}^{2}/ha\)).</p></li>
<li><p><code>V</code>: stand volume (\({m}^{3}/ha\)).</p></li>
<li><p><code>d</code>, <code>dg</code>, <code>dgeom</code>, <code>dharm</code>: mean tree
      diameters (cm) at breast height (1.3 m), calculated from the arithmetic mean, quadratic
      mean, geometric mean and harmonic mean, respectively.</p></li>
<li><p><code>h</code>, <code>hg</code>, <code>hgeom</code>, <code>hharm</code>: mean tree
      heights (m), calculated from the arithmetic mean, quadratic mean, geometric mean and
      harmonic mean, respectively.</p></li>
<li><p><code>d.0</code>, <code>dg.0</code>, <code>dgeom.0</code>, <code>dharm.0</code>: dominant
      mean tree diameters (cm) at breast height (1.3 m), calcualted from the arithmetic mean,
      quadratic mean, geometric mean and harmonic mean, respectively.</p></li>
<li><p><code>h.0</code>, <code>hg.0</code>, <code>hgeom.0</code>, <code>hharm.0</code>: dominant
      mean tree heights (m), calculated from the arithmetic mean, quadratic mean, geometric
      mean and harmonic mean, respectively.</p></li>
</ul><p>TLS variables derived from simulated TLS plots:</p><ul><li><p><code>N.tls</code>: stand density (trees/ha) without occlusion
      corrections.</p></li>
<li><p><code>N.hn</code>, <code>N.hr</code>, <code>N.hn.cov</code>, <code>N.hr.cov</code>: stand
      density (trees/ha) with occlusion corrections based on distance sampling
      methodologies. These columns will be missing if the <code>distance.sampling</code>
      argument is <code>NULL</code>.</p></li>
<li><p><code>N.sh</code>: stand density (trees/ha) with correction of the
      shadowing effect.</p></li>
<li><p><code>G.tls</code>: stand basal area (\({m}^{2}/ha\)) without occlusion
      corrections.</p></li>
<li><p><code>G.hn</code>, <code>G.hr</code>, <code>G.hn.cov</code>, <code>G.hr.cov</code>: stand
      basal area (\({m}^{2}/ha\)) with occlusion corrections based on distance sampling
      methodologies. These columns will be missing if the <code>distance.sampling</code>
      argument is <code>NULL</code>.</p></li>
<li><p><code>G.sh</code>: stand basal area (\({m}^{2}/ha\)) with correction of the
      shadowing effect.</p></li>
<li><p><code>V.tls</code>: stand volume (\({m}^{3}/ha\)) without occlusion corrections.</p></li>
<li><p><code>V.hn</code>, <code>V.hr</code>, <code>V.hn.cov</code>, <code>V.hr.cov</code>: stand
      volume (\({m}^{3}/ha\)) with occlusion corrections based on distance sampling
      methodologies. These  columns will be missing if the <code>distance.sampling</code>
      argument is <code>NULL</code>.</p></li>
<li><p><code>V.sh</code>: stand volume (\({m}^{3}/ha\)) with correction of the
      shadowing effect.</p></li>
<li><p><code>d.tls</code>, <code>dg.tls</code>, <code>dgeom.tls</code>, <code>dharm.tls</code>:
      mean tree diameters (cm) at breast height (1.3 m), calculated from the arithmetic mean,
      quadratic mean geometric mean, and harmonic mean, respectively.</p></li>
<li><p><code>h.tls</code>, <code>hg.tls</code>, <code>hgeom.tls</code>, <code>hharm.tls</code>:
      mean tree heights (m), calculated from the arithmetic mean, quadratic mean, geometric
      mean and harmonic mean, respectively.</p></li>
<li><p><code>d.0.tls</code>, <code>dg.0.tls</code>, <code>dgeom.0.tls</code>,
      <code>dharm.0.tls</code>: dominant mean tree diameters (cm) at breast height
      (1.3 m), calculated from the arithmetic mean, quadratic mean, geometric mean and
      harmonic mean, respectively.</p></li>
<li><p><code>h.0.tls</code>, <code>hg.0.tls</code>, <code>hgeom.0.tls</code>,
      <code>hharm.0.tls</code>: dominant mean tree heights (m), calculated from the arithmetic
      mean, quadratic mean, geometric mean and harmonic mean, respectively.</p></li>
</ul><p>TLS metrics derived from simulated TLS plots:</p><ul><li><p><code>num.points</code>, <code>num.points.est</code>, <code>num.points.hom</code>,
      <code>num.points.hom.est</code>: number of points and estimated number of
      points (points) belonging to trees with normal sections (+/- 5 cm) in the
      original point cloud (<code>num.points</code> and <code>num.points.est</code>,
      respectively); and number of points and estimated number of points
      (points) belonging to trees normal sections (+/- 5 cm) in the reduced
      point cloud (<code>num.points.hom</code> and <code>num.points.hom.est</code>,
      respectively).</p></li>
<li><p><code>P01</code>, <code>P05</code>, <code>P10</code>, <code>P20</code>, <code>P25</code>,
      <code>P30</code>, <code>P40</code>, <code>P50</code>, <code>P60</code>, <code>P70</code>, <code>P75</code>,
      <code>P80</code>, <code>P90</code>, <code>P95</code>, <code>P99</code>: height percentiles
      derived from z coordinates of TLS point clouds relative to ground level.</p></li>
</ul><p></p></dd>


  <dt>k.tree.plot</dt>
<dd><p>If no value for <code>k.tree.max</code> is specified in the <code>plot.parameters</code>
  argument, <code>NULL</code>; otherwise the data frame with TLS metrics and estimations
  of variables will be based on simulated plots in the k-tree plot design. Each of row will correspond to a (plot, k) pair, and the following
  columns will be included:</p>
<p>Plot identification and k:</p><ul><li><p><code>id</code>: plot identification encoded as character string or
      numeric. The <code>id</code> will coincide with those included in the <code>id</code>
      column of <code>tree.tls</code>, <code>tree.field</code> or, if applicable,
      <code>distance.sampling</code> arguments.</p></li>
<li><p><code>k</code>: number of trees (trees) in the simulated plot.</p></li>
</ul><p>Estimated variables based on simulated field plots:</p><ul><li><p><code>N</code>, <code>G</code>, <code>V</code>, <code>d</code>, <code>dg</code>, <code>dgeom</code>,
      <code>dharm</code>, <code>h</code>, <code>hg</code>, <code>hgeom</code>, <code>hharm</code>,
      <code>d.0</code>, <code>dg.0</code>, <code>dgeom.0</code>, <br><code>dharm.0</code>, <code>h.0</code>,
      <code>hg.0</code>, <code>hgeom.0</code>, <code>hharm.0</code>: same description and format
      as indicated in the <code>fixed.area.plot</code> element.</p></li>
</ul><p>TLS variables derived from simulated TLS plots:</p><ul><li><p><code>N.tls</code>, <code>N.hn</code>, <code>N.hr</code>, <code>N.hn.cov</code>, <code>N.hr.cov</code>, <code>N.sh</code>, <br><code>G.tls</code>, <code>G.hn</code>, <code>G.hr</code>, <code>G.hn.cov</code>, <code>G.hr.cov</code>, <code>G.sh</code>, <br><code>V.tls</code>, <code>V.hn</code>, <code>V.hr</code>, <code>V.hn.cov</code>, <code>V.hr.cov</code>, <code>V.sh</code>, <br><code>d.tls</code>, <code>dg.tls</code>, <code>dgeom.tls</code>, <code>dharm.tls</code>, <br><code>h.tls</code>, <code>hg.tls</code>, <code>hgeom.tls</code>, <code>hharm.tls</code>, <br><code>d.0.tls</code>, <code>dg.0.tls</code>, <code>dgeom.0.tls</code>, <code>dharm.0.tls</code>, <br><code>h.0.tls</code>, <code>hg.0.tls</code>, <code>hgeom.0.tls</code>, <code>hharm.0.tls</code></p></li>
</ul><p>TLS metrics derived from simulated TLS plots:</p><ul><li><p><code>num.points</code>, <code>num.points.est</code>, <code>num.points.hom</code>, <code>num.points.hom.est</code>, <br><code>P01</code>, <code>P05</code>, <code>P10</code>, <code>P20</code>, <code>P25</code>, <code>P30</code>, <code>P40</code>, <code>P50</code>, <code>P60</code>, <code>P70</code>, <code>P75</code>, <code>P80</code>, <code>P90</code>, <code>P95</code>, <code>P99</code>: same description and format as indicated in
      <code>fixed.area.plot</code> element.</p></li>
</ul></dd>



  <dt>angle.count.plot</dt>
<dd><p>If no value for <code>BAF.max</code> is specified in the <code>plot.parameters</code>
  argument, <code>NULL</code>; otherwise the data frame will include TLS metrics and estimated
  variables based on simulated plots in the angle-count plot design. Each
  row will correspond to a (plot, BAF) pair, and the
  following columns will be included:</p>
<p>Plot identification and BAF:</p><ul><li><p><code>id</code>: plot identification encoded as character string or
      numeric. The <code>id</code> will coincide with those included in the <code>id</code>
      column of <code>tree.tls</code> and <code>tree.field</code>.</p></li>
<li><p><code>BAF</code>: BAF (\({m}^{2}/ha\)) of the simulated plot.</p></li>
</ul><p>Estimated variables based on simulated field plots:</p><ul><li><p><code>N</code>, <code>G</code>, <code>V</code>, <code>d</code>, <code>dg</code>, <code>dgeom</code>,
      <code>dharm</code>, <code>h</code>, <code>hg</code>, <code>hgeom</code>, <code>hharm</code>,
      <code>d.0</code>, <code>dg.0</code>, <code>dgeom.0</code>, <br><code>dharm.0</code>, <code>h.0</code>,
      <code>hg.0</code>, <code>hgeom.0</code>, <code>hharm.0</code>: same description and format
      as indicated in the <code>fixed.area.plot</code> element.</p></li>
</ul><p>TLS variables derived from simulated TLS plots:</p><ul><li><p><code>N.tls</code>: same description and format as indicated in the
      <code>fixed.area.plot</code> element.</p></li>
<li><p><code>N.pam</code>: stand density (trees/ha) with occlusion correction
      based on gap probability attenuation with distance to TLS.</p></li>
<li><p><code>G.tls</code>: same description and format as indicated in
      <code>fixed.area.plot</code> element.</p></li>
<li><p><code>G.pam</code>: stand basal area (\({m}^{2}/ha\)) with occlusion correction
      based on gap probability attenuation with distance to TLS.</p></li>
<li><p><code>V.tls</code>: same description and format as indicated in
      <code>fixed.area.plot</code> element.</p></li>
<li><p><code>V.pam</code>: stand volume (\({m}^{3}/ha\))with occlusion correction based
      on gap probability attenuation with distance to TLS.</p></li>
<li><p><code>d.tls</code>, <code>dg.tls</code>, <code>dgeom.tls</code>, <code>dharm.tls</code>, <br><code>h.tls</code>, <code>hg.tls</code>, <code>hgeom.tls</code>, <code>hharm.tls</code>, <br><code>d.0.tls</code>, <code>dg.0.tls</code>, <code>dgeom.0.tls</code>, <code>dharm.0.tls</code>, <br><code>h.0.tls</code>, <code>hg.0.tls</code>, <code>hgeom.0.tls</code>, <code>hharm.0.tls</code></p></li>
</ul><p>TLS metrics derived from simulated TLS plots:</p><ul><li><p><code>num.points</code>, <code>num.points.est</code>, <code>num.points.hom</code>,
      <code>num.points.hom.est</code>, <br><code>P01</code>, <code>P05</code>, <code>P10</code>, <code>P20</code>, <code>P25</code>, <code>P30</code>,
      <code>P40</code>, <code>P50</code>, <code>P60</code>, <code>P70</code>, <code>P75</code>, <code>P80</code>,
      <code>P90</code>, <code>P95</code>, <code>P99</code>: same description and format as
      indicated in <code>fixed.area.plot</code> element.</p></li>
</ul><p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="output-files">Output Files<a class="anchor" aria-label="anchor" href="#output-files"></a></h2>
    <p>At the end of the simulation process, if the <code>save.result</code> argument is
<code>TRUE</code>, the function will print all the elements described in
‘Value’ section and which are different from <code>NULL</code> to files. Data frames are
written without row names in <code>dir.result</code> directory using
the <code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></code> function from the <span class="pkg">utils</span> package. The pattern used
for naming these files is <code class="file">simulations.&lt;plot design&gt;.csv</code>, where
<code class="file">&lt;plot design&gt;</code> is equal to “<code>fixed.area.plot</code>”,
“<code>k.tree.plot</code>” or “<code>angle.count.plot</code>” according to
plot design.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Astrup, R., Ducey, M. J., Granhus, A., Ritter, T., &amp; von Lüpke, N. (2014).
Approaches for estimating stand level volume using terrestrial laser scanning
in a single-scan mode. <em>Canadian Journal of Forest Research</em>,
<b>44(6)</b>, 666-676. <a href="https://doi.org/10.1139/cjfr-2013-0535" class="external-link">doi:10.1139/cjfr-2013-0535</a></p>
<p>IUFRO (1959). <em>Standarization of symbols in forest mensuration</em>. IUFRO,
Wien, 32 pp.</p>
<p>Lovell, J. L., Jupp, D. L. B., Newnham, G. J., &amp; Culvenor, D. S. (2011).
Measuring tree stem diameters using intensity profiles from ground-based
scanning lidar from a fixed viewpoint. <em>ISPRS Journal of Photogrammetry
and Remote Sensing</em>, <b>66(1)</b>, 46-55. <a href="https://doi.org/10.1016/j.isprsjprs.2010.08.006" class="external-link">doi:10.1016/j.isprsjprs.2010.08.006</a></p>
<p>Seidel, D., &amp; Ammer, C. (2014). Efficient measurements of basal area in short
rotation forests based on terrestrial laser scanning under special
consideration of shadowing. <em>iForest-Biogeosciences and Forestry</em>,
<b>7(4)</b>, 227. <a href="https://doi.org/10.3832/ifor1084-007" class="external-link">doi:10.3832/ifor1084-007</a></p>
<p>Strahler, A. H., Jupp, D. L. B., Woodcock, C. E., Schaaf, C. B., Yao, T., Zhao,
F., Yang, X., Lovell, J., Culvenor, D., Newnham, G., Ni-Miester, W., &amp;
Boykin-Morris, W. (2008). Retrieval of forest structural parameters using a
ground-based lidar instrument (Echidna®). <em>Canadian Journal of Remote
Sensing</em>, <b>34(sup2)</b>, S426-S440. <a href="https://doi.org/10.5589/m08-046" class="external-link">doi:10.5589/m08-046</a></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The simulation process implemented in this function is computationally intensive.
Although the function currently uses the <code>vroom</code> function from the <a href="https://CRAN.R-project.org/package=vroom" class="external-link"><span class="pkg">vroom</span></a> package for reading large files and contains fast implementations of
several critical calculations (C++ via <a href="https://CRAN.R-project.org/package=Rcpp" class="external-link"><span class="pkg">Rcpp</span></a> package), long
computation times may be required when a large number of plots are considered,
number of points in TLS point clouds are very high, or the radius, k
or BAF sequences used in the simulation process are very long.</p>
<p>Using reduced point clouds (according to point cropping process implemented in the
<code><a href="normalize.html">normalize</a></code> function), rather than original ones, may be
recommended in order to cut down on computing time. Another possibility would
be to specify large increments for radius
and BAF, and/or low maximum values for radius, number of trees and BAF in the <code>plot.parameters</code> argument. This
would make the function more efficient, though there may be a notable
loss of detail in the results generated.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Juan Alberto Molina-Valero, María José Ginzo Villamayor,
Manuel Antonio Novo Pérez, Adela Martínez-Calvo, Juan Gabriel Álvarez-González,
Fernando Montes and César Pérez-Cruzado.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="tree.detection.single.scan.html">tree.detection.single.scan</a></code>, <code><a href="tree.detection.multi.scan.html">tree.detection.multi.scan</a></code>, <code><a href="tree.detection.several.plots.html">tree.detection.several.plots</a></code>, <code><a href="distance.sampling.html">distance.sampling</a></code>,
<code><a href="normalize.html">normalize</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Load information of trees detected from TLS point clouds data corresponding to</span></span>
<span class="r-in"><span class="co"># plot 1 from Rioja data set</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Rioja.data"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">example.tls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Rioja.data</span><span class="op">$</span><span class="va">tree.tls</span>, <span class="va">id</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compute detection probabilities using distance sampling methods</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">example.ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="distance.sampling.html">distance.sampling</a></span><span class="op">(</span><span class="va">example.tls</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>First partial hessian is singular; using second-partial hessian</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>First partial hessian is singular; using second-partial hessian</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>First partial hessian is singular; using second-partial hessian</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Load information of trees measured in field plots corresponding to plot 1 from</span></span>
<span class="r-in"><span class="co"># Rioja data set</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">example.field</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Rioja.data</span><span class="op">$</span><span class="va">tree.field</span>, <span class="va">id</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Establish directory where TXT file containing TLS point cloud corresponding to</span></span>
<span class="r-in"><span class="co"># plot 1 from Rioja data set is located. For instance, current working directory</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dir.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Download example of TXT file corresponding to plot 1 from Rioja data set</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://www.dropbox.com/s/w4fgcyezr2olj9m/Rioja_1.txt?dl=1"</span>,</span>
<span class="r-in">              destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir.data</span>, <span class="st">"1.txt"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Establish directory where simulation results corresponding to plot 1 from</span></span>
<span class="r-in"><span class="co"># Rioja data set will be saved. For instance, current working directory</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dir.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compute metrics and variables for simulated TLS and field plots corresponding</span></span>
<span class="r-in"><span class="co"># to plot 1 from Rioja data set</span></span>
<span class="r-in"><span class="co"># Without occlusion correction based on distance sampling methods</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">simulations</span><span class="op">(</span>tree.tls <span class="op">=</span> <span class="va">example.tls</span>, tree.field <span class="op">=</span> <span class="va">example.field</span>,</span>
<span class="r-in">                   plot.parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>radius.max <span class="op">=</span> <span class="fl">10</span>, k.max <span class="op">=</span> <span class="fl">20</span>,</span>
<span class="r-in">                                                BAF.max <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">                   dir.data <span class="op">=</span> <span class="va">dir.data</span>, dir.result <span class="op">=</span> <span class="va">dir.result</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing simulations for plot: '1'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>cannot xtfrm data frames</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  (304.54 secs)</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Juan Alberto Molina-Valero, Adela Martínez-Calvo, Anika Seppelt, Juan Gabriel Álvarez-González, Fernando Montes, César Pérez-Cruzado.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

